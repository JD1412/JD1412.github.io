<!DOCTYPE html>












  


<html class="theme-next gemini use-motion" lang="zh-CN">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">




  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link rel="stylesheet" href="/lib/pace/pace-theme-center-atom.min.css?v=1.0.2">




















  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext">
  






<link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2">

<link rel="stylesheet" href="/css/main.css?v=6.7.0">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=6.7.0">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=6.7.0">


  <link rel="mask-icon" href="/images/logo.svg?v=6.7.0" color="#222">







<script id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Gemini',
    version: '6.7.0',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: false,
    fastclick: false,
    lazyload: false,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>


  




  <meta name="description" content="PWN 学习笔记原理知识：  基础篇(栈的原理)：  https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/1234https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/http://www.cnblogs.com/clover-toeic/">
<meta name="keywords" content="PWN,GDB,peda,gef,pwndbg,PWNTOOLS,ASLR,DEP,堆,栈,objdump">
<meta property="og:type" content="article">
<meta property="og:title" content="PWN 学习笔记">
<meta property="og:url" content="https://github.com/JD1412/JD1412.github.io.git/2019/01/14/PWN-学习笔记/index.html">
<meta property="og:site_name" content="JD1412">
<meta property="og:description" content="PWN 学习笔记原理知识：  基础篇(栈的原理)：  https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/1234https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/http://www.cnblogs.com/clover-toeic/">
<meta property="og:locale" content="zh-CN">
<meta property="og:image" content="https://github.com/2019/01/14/PWN-学习笔记/gdbtiaoshi.png">
<meta property="og:updated_time" content="2019-01-14T02:23:35.649Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="PWN 学习笔记">
<meta name="twitter:description" content="PWN 学习笔记原理知识：  基础篇(栈的原理)：  https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/1234https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/http://www.cnblogs.com/clover-toeic/">
<meta name="twitter:image" content="https://github.com/2019/01/14/PWN-学习笔记/gdbtiaoshi.png">



  <link rel="alternate" href="/atom.xml" title="JD1412" type="application/atom+xml">




  <link rel="canonical" href="https://github.com/JD1412/JD1412.github.io.git/2019/01/14/PWN-学习笔记/">



<script id="page.configurations">
  CONFIG.page = {
    sidebar: "",
  };
</script>

  <title>PWN 学习笔记 | JD1412</title>
  












  <noscript>
  <style>
  .use-motion .motion-element,
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-title { opacity: initial; }

  .use-motion .logo,
  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>
    <a href="https://github.com/JD1412/JD1412.github.io" class="github-corner" aria-label="View source on GitHub"><svg width="80" height="80" viewbox="0 0 250 250" style="fill:#151513; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"/><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"/><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"/></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">JD1412</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
    
      
        <p class="site-subtitle">黑色的眼睛</p>
      
    
    
  </div>

  <div class="site-nav-toggle">
    <button aria-label="切换导航栏">
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>



<nav class="site-nav">
  
    <ul id="menu" class="menu">
      
        
        
        
          
          <li class="menu-item menu-item-home">

    
    
    
      
    

    

    <a href="/" rel="section"><i class="menu-item-icon fa fa-fw fa-home"></i> <br>首页</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-tags">

    
    
    
      
    

    

    <a href="/tags/" rel="section"><i class="menu-item-icon fa fa-fw fa-tags"></i> <br>标签</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-categories">

    
    
    
      
    

    

    <a href="/categories/" rel="section"><i class="menu-item-icon fa fa-fw fa-th"></i> <br>分类</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-archives">

    
    
    
      
    

    

    <a href="/archives/" rel="section"><i class="menu-item-icon fa fa-fw fa-archive"></i> <br>归档</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-schedule">

    
    
    
      
    

    

    <a href="/schedule/" rel="section"><i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>日程表</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-sitemap">

    
    
    
      
    

    

    <a href="/sitemap.xml" rel="section"><i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>站点地图</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-commonweal">

    
    
    
      
    

    

    <a href="/404/" rel="section"><i class="menu-item-icon fa fa-fw fa-heartbeat"></i> <br>公益 404</a>

  </li>
        
        
        
          
          <li class="menu-item menu-item-about">

    
    
    
      
    

    

    <a href="/about/" rel="section"><i class="menu-item-icon fa fa-fw fa-user"></i> <br>关于</a>

  </li>

      
      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>搜索</a>
        </li>
      
    </ul>
  

  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



  



</div>
    </header>

    


    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          
            

          
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://github.com/JD1412/JD1412.github.io.git/2019/01/14/PWN-学习笔记/">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Healer">
      <meta itemprop="description" content="桃李不言，下自成蹊">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="JD1412">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">PWN 学习笔记

              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">

            
            
            

            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              

              
                
              

              <time title="创建时间：2019-01-14 06:42:26 / 修改时间：10:23:35" itemprop="dateCreated datePublished" datetime="2019-01-14T06:42:26+08:00">2019-01-14</time>
            

            
              

              
            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing"><a href="/categories/pwn/" itemprop="url" rel="index"><span itemprop="name">PWN</span></a></span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <a id="more"></a>
<h1 id="PWN-学习笔记"><a href="#PWN-学习笔记" class="headerlink" title="PWN 学习笔记"></a>PWN 学习笔记</h1><p>原理知识：</p>
<ul>
<li><p>基础篇(栈的原理)：</p>
<ul>
<li><code>https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/</code><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stack_intro/</span><br><span class="line">http://www.cnblogs.com/clover-toeic/p/3755401.html</span><br><span class="line">http://www.mamicode.com/info-detail-1990426.html</span><br><span class="line">https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/stackoverflow_basic/</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p><strong>file</strong> 命令： 用来探测给定文件的类型。file命令对文件的检查分为文件系统、魔法幻数检查和语言检查3个过程</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop<span class="comment"># file what_the_fuck</span></span><br><span class="line">what_the_fuck: ELF <span class="number">64</span>-bit LSB executable, x86<span class="number">-64</span>, version <span class="number">1</span> (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86<span class="number">-64.</span>so<span class="number">.2</span>, <span class="keyword">for</span> GNU/Linux <span class="number">2.6</span><span class="number">.32</span>, BuildID[sha1]=f5874ff98d454f054743d010a0456a89f09aa535, stripped</span><br></pre></td></tr></table></figure>
</li>
<li><p>checksec命令： 该脚本来查询该文件使用了哪些防护技术</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop# checksec what_the_fuck</span><br><span class="line">[*] &apos;/root/Desktop/what_the_fuck&apos;</span><br><span class="line">    Arch:     amd64-64-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    Canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x400000)</span><br></pre></td></tr></table></figure>
</li>
<li><p>数据保护机制：</p>
<ul>
<li><p><strong>NX</strong>  类似于(windows上的<strong>DEP</strong>)</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在AMD64位CPU上，在页面表（page table）中的页面信息加了一个特殊的位，NX位（No eXecute）。</span><br><span class="line">如果NX位为0，这个页面上可以执行指令。</span><br><span class="line">如果NX位为1，这个页面上不允许执行指令。如果试图执行指令的话，就会产生异常。</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Stack Canary</strong></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">在缓冲区和控制信息（如 EBP 等）间插入一个 canary word。</span><br><span class="line">这样，当缓冲区被溢出时，在返回地址被覆盖之前 canary word 会首先被覆盖。</span><br><span class="line">通过检查 canary word 的值是否被修改，就可以判断是否发生了溢出攻击</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>PIE</strong> 地址空间分布随机化 <strong>ALSR</strong></p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">内存地址随机化机制（address space layout randomization)，有以下三种情况</span><br><span class="line"></span><br><span class="line">0 - 表示关闭进程地址空间随机化。</span><br><span class="line">1 - 表示将mmap的基址，stack和vdso页面随机化。</span><br><span class="line">2 - 表示在1的基础上增加栈（heap）的随机化。</span><br><span class="line">可以防范基于Ret2libc方式的针对DEP的攻击。ASLR和DEP配合使用，能有效阻止攻击者在堆栈上运行恶意代码。</span><br><span class="line"></span><br><span class="line">Built as PIE：位置独立的可执行区域（position-independent executables）。</span><br><span class="line">这样使得在利用缓冲溢出和移动操作系统中存在的其他内存崩溃缺陷时采用面向返回的编程（return-oriented programming）方法变得难得多。</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>RELRO</strong> 符号重定向表格</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">设置符号重定向表格为只读或在程序启动时就解析并绑定所有动态符号，从而减少对GOT（Global Offset Table）攻击。</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<h2 id="linux保护机制整理"><a href="#linux保护机制整理" class="headerlink" title="linux保护机制整理"></a>linux保护机制整理</h2><p>DEP，ASLR，更强的Selinux，内核代码段只读，PXN</p>
<p>DEP，ASLR，Selinux等技术在PC时代就已经比较成熟了。内核代码段只读也是可以通过修改ptmx_fops指针表等方案来绕过</p>
<ul>
<li><p>DEP（windows）、NX（linux）堆栈代码执行保护<br> 绕过方法：</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">使用 （ROP）Return-Oriented Programming.绕过 (如ret2data、ret2libc、ret2strcpy、ret2gets、ret2syscall)</span><br><span class="line">gadget:virtualprotect、jmp esp、mona.py</span><br></pre></td></tr></table></figure>
</li>
<li><p>ASLR 地址随机化</p>
<ul>
<li><p>绕过方法：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1、直接RET替换（一般进程也会加载没有随机化的模块，可以找到JMP ESP指令的跳板直接调用）</span><br><span class="line">2、替换EIP一部分（找到没有随机化的模块然后使用利息泄漏确定EIP的位置，再算出模块的基地址，最后算出要跳的函数地址）</span><br><span class="line">3、NOP喷射（DEP没开的情况下，创建一大块NOP+shellcode，Heap Spray是在shellcode的前面加上大量的slide code（滑板指令），组成一个注入代码段。然后向系统申请大量内存，并且反复用注入代码段来填充。这样就使得进程的地址空间被大量的注入代码所占据。然后结合其他的漏洞攻击技术控制程序流，使得程序执行到堆上，最终将导致shellcode的执行。</span><br><span class="line">  统slide code（滑板指令）一般是NOP指令，譬如0x0C（0x0C0C代表的x86指令是OR AL 0x0C），0x0D等等，不影响程序的执行的。）</span><br><span class="line">4、暴力（如果漏洞不会造成程序崩溃，可以暴力测试256种模块基地址来测试，只到有满足的）最LOW</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>Self-Protection Project(KSPP)</p>
</li>
<li><p>内核代码段和常量数据只读保护</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">mark_rodata_ro</span><br><span class="line">写保护的实现是通过set_memory_ro函数内部调用实现set_page_attributes来实现的。</span><br><span class="line">攻击方法：</span><br><span class="line"></span><br><span class="line">针对这种页保护的防御，较常用的方法是,从物理页表中取相应的页表条目，找到页表描述符，修改相应的权限。我们可以通过利用内核中现成的代码来完成    页表属性的修改。我们发现可以通过内核导出函数set_memory_rw来打开内核页表的读写权限。set_memory_rw函数的定义如下：</span><br><span class="line"></span><br><span class="line">int set_memory_rw(unsigned long virt, int numpages)</span><br></pre></td></tr></table></figure>
</li>
<li><p>PXN( PrivilegedExecute-Never ) “特权执行从不”<br>  PXN的绕过方法：</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">利用ROP技术绕过PXN</span><br><span class="line">ROP主要原理是通过控制内存中的一段数据，通过控制数据来控制代码执行流，如组合执行内核中特定的代码片段，从而达到修改内核中的关键数据，达到提权限的目的。这种攻击方式是需要进行不同机型中查找到多段代码片段，如果需要root的机型较多，则需要攻击者投入较多精力去做适配。</span><br><span class="line"></span><br><span class="line">利用RET2DIR技术</span><br><span class="line">利用原理是，Linux内核在设计的时候，在用户空间映射内存的时候，为了提高内存的操作效率，内核也相应地在内核的低端内存区地址映射一段影子内存。</span><br><span class="line"></span><br><span class="line">者利用该缺陷，将用户空间的攻击代码映射到内核的低端内存可执行区或者将特定数据进行喷射到内核的低端内存，进行内存布局，然后利用发现的漏洞，让内核执行攻击代码，从而达到提权的作用。这项技术在32位arm设备上有65%以上的成功率，而在64位arm中有96%的成功率。</span><br><span class="line">与ROP不同，RET2DIR这项技术不需要对内核代码进行重利用和组合，就可以直接将攻击代码或数据映射到内核的低端内存。</span><br><span class="line">由于64位ARM内核的设备都已经开启了PXN防护，这项技术成为通用root工具绕过64位ARM内核的PXN必备技术。在KingRoot的cve-2015-3636和cve-2016-1805漏洞利用中都使用到了该技术绕过PXN防护。</span><br><span class="line"></span><br><span class="line">通过内核特定函数完成PXN绕过。</span><br><span class="line">该技术在2016年MOSEC大会上由360团队公开，该技术巧妙地利用kernel_setsockopt函数的特性，通过控制r0, 让内核执行set_fs(KERNEL_DS),实现任意地址读写权限的效果。</span><br></pre></td></tr></table></figure>
</li>
<li><p>KNOX绕过</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">三星KNOX里对内核保护主要由TIMA完成。TIMA 使用 ARM TrustZone硬件，持续的监控linux内核的完整性。</span><br><span class="line">Linux内核采用的CRC完整性认证机制不同，TIMA采用了数字证书签名技术对加载的内核模块进行合法性验证，以确保每个加载的模块都是合法的。</span><br><span class="line"></span><br><span class="line">在2014年SyScan360大会上360团队的陈章琪和申迪介绍了TIMA LKM验证机制的绕过方法。他们的思路是通过Patch内核的代码，绕过TIMA验证。具体的攻击方法如下：</span><br></pre></td></tr></table></figure>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="built_in">memcmp</span>(hdr-&gt;e_ident, ELFMAG, SELFMAG) != <span class="number">0</span></span><br><span class="line">    || hdr-&gt;e_type != ET_REL || elf_check_arch(hdr)</span><br><span class="line">    || hdr-&gt;e_shentsize != <span class="keyword">sizeof</span>(Elf_shdr))&#123;</span><br><span class="line">    err = -ENOEXEC;</span><br><span class="line">    <span class="keyword">goto</span> free_hdr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(len &lt; hdr-&gt;e_snoff + hdr-&gt;e_shnum * <span class="keyword">sizeof</span>(Elf_shdr))&#123;</span><br><span class="line">    err = -ENOEXEC;</span><br><span class="line">    <span class="keyword">goto</span> free_hdr;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> TIMA_LKM_AUTH_ENABLED</span></span><br><span class="line">    <span class="keyword">if</span>(lkmauth_bootmode != BOOTMODE_RECOVERY &amp;&amp;</span><br><span class="line">            lkmauth(hdr, len) != RET_LKMAUTH_SUSSESS)&#123;</span><br><span class="line">        pr_err</span><br><span class="line">            (<span class="string">"TIMA:lkmauth--unable to load kernel module;module len is %1u,\n"</span>,len);</span><br><span class="line">        err = -ENOEXEC;</span><br><span class="line">        <span class="keyword">goto</span> free_hdr;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">endif</span></span></span><br><span class="line">    info-&gt;hdr = hdr;</span><br><span class="line">    info-&gt;len = len;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br></pre></td></tr></table></figure>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">X2.0，TIMA引入了实时内核保护(RKP)技术。RKP可在TrustZone内对操作系统进行持续不断且富有策略性的实时监控，以防止篡改内核。</span><br><span class="line"></span><br><span class="line">RKP可对内核内部发生的重要事件进行审计（可在ARM中进行检查）。如果确定某个事件对 OS 内核的完整性具有影响，则 RKP 将会停止该事件，或记录怀疑存在篡改行为的认证结论，并将其发送至 MDM。这可以防止恶意修改和注入内核代码，包括强制内核破坏自身的数据。</span><br><span class="line"></span><br><span class="line">在2.0版本的RKP除了保护页表之外，还保护一些关键的内核对象（如cred,real_cred）。RKP将存储关键安全信息对象的kmem_cache里所有的页都设为只读，只能在TIMA里面对kmem_cache里的页进行写操作。</span><br><span class="line"></span><br><span class="line">在MOSEC2016大会上，科恩实验室的方家弘介绍了KingRoot产品中修改这些关键安全数据，实现DKOM的方法。KingRoot的方法是利用cve-2015-1805的任意地址写的漏洞，修改file_operations里的int (*check_flags)(int) 函数指针，使得函数指针指向override_creds函数。</span><br><span class="line"></span><br><span class="line">通过控制check_flags函数输入参数，使得TIMA主动修改cred的值，从而绕过RKP防护，达到提权的效果。</span><br><span class="line"></span><br><span class="line">除了防止运行时修改关键的安全数据结构之外，RKP还对一些系统调用进行监控，如execve系统调用。</span><br><span class="line"></span><br><span class="line">对于任何的ROOT进程，sec_restrict_fork函数将判断是否该进程的路径是来自/data目录，正常情况下，该目录是存放用户程序的唯一路径。三星希望这样可以阻止类似SU这样的程序可以给/DATA/目录下的用户程序赋权限的情况发生。但是，我们可以依然可以修改一些关键数据来绕过sec_restrict_fork函数的判断</span><br></pre></td></tr></table></figure>
</li>
<li><h2 id="分析漏洞"><a href="#分析漏洞" class="headerlink" title="分析漏洞"></a>分析漏洞</h2></li>
<li><h2 id="写exp"><a href="#写exp" class="headerlink" title="写exp"></a>写exp</h2></li>
</ul>
<h2 id="PWNTOOLS的基本使用方法"><a href="#PWNTOOLS的基本使用方法" class="headerlink" title="PWNTOOLS的基本使用方法"></a>PWNTOOLS的基本使用方法</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">context.binary(./elf)  <span class="comment">#The recommended method is to use context.binary to automagically set all of the appropriate values.</span></span><br><span class="line">context.arch = <span class="string">'amd64'</span>   <span class="comment">#Which sets up everything in the exploit for exploiting a 64-bit Intel binary.</span></span><br><span class="line">context.update(arch=<span class="string">'i386'</span>, os=<span class="string">'linux'</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>context.clear()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>context.update(os=<span class="string">'linux'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>context.os == <span class="string">'linux'</span></span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>context.arch = <span class="string">'arm'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>vars(context) == &#123;<span class="string">'arch'</span>: <span class="string">'arm'</span>, <span class="string">'bits'</span>: <span class="number">32</span>, <span class="string">'endian'</span>: <span class="string">'little'</span>, <span class="string">'os'</span>: <span class="string">'linux'</span>&#125;</span><br><span class="line"><span class="keyword">True</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>context.endian</span><br><span class="line"><span class="string">'little'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>context.bits</span><br><span class="line"><span class="number">32</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="function"><span class="keyword">def</span> <span class="title">nop</span><span class="params">()</span>:</span></span><br><span class="line"><span class="meta">... </span>  <span class="keyword">print</span> pwnlib.asm.asm(<span class="string">'nop'</span>).encode(<span class="string">'hex'</span>)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nop()</span><br><span class="line"><span class="number">00</span>f020e3</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> context.local(arch = <span class="string">'i386'</span>):</span><br><span class="line"><span class="meta">... </span>  nop()</span><br><span class="line"><span class="number">90</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> pwnlib.context <span class="keyword">import</span> Thread <span class="keyword">as</span> PwnThread</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">from</span> threading      <span class="keyword">import</span> Thread <span class="keyword">as</span> NormalThread</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">with</span> context.local(arch = <span class="string">'mips'</span>):</span><br><span class="line"><span class="meta">... </span>    pwnthread = PwnThread(target=nop)</span><br><span class="line"><span class="meta">... </span>    thread    = NormalThread(target=nop)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Normal thread uses the default value for arch, 'i386'</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_=(thread.start(), thread.join())</span><br><span class="line"><span class="number">90</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="comment"># Pwnthread uses the correct context from creation-time</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>_=(pwnthread.start(), pwnthread.join())</span><br><span class="line"><span class="number">00000000</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>nop()</span><br><span class="line"><span class="number">00</span>f020e3</span><br></pre></td></tr></table></figure>
<table>
<thead>
<tr>
<th>命令</th>
<th>功能</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>elf = ELF(&quot;./easypwn&quot;)</code></td>
<td>在本地静态加载可执行文件</td>
</tr>
<tr>
<td><code>mian = elf.symbols[&#39;main&#39;]</code></td>
<td>获取本地加载的elf文件的某个函数的加载地址</td>
</tr>
<tr>
<td><code>io.process(&#39;./easypwn&#39;)</code></td>
<td>在本地加载可执行文件</td>
</tr>
<tr>
<td><code>io.recvuntil(&#39;elf_String\n&#39;)</code></td>
<td>运行程序后直到接收到字符串（elf_String）之后</td>
</tr>
<tr>
<td><code>io.sendline(&#39;string&#39;)</code></td>
<td>向进程发送一行数据结尾包<strong>含换行符</strong>（0x0a）</td>
</tr>
<tr>
<td><code>io.send(&#39;string&#39;)</code></td>
<td>向进程发送数据<strong>不包含换行符</strong></td>
</tr>
<tr>
<td><code>p64(data)/p32(data)</code></td>
<td>将数据打包为64/32位运行环境字节码</td>
</tr>
<tr>
<td><code>u64(data)/u32(data)</code></td>
<td>将数据解包为64/32位环境字节</td>
</tr>
<tr>
<td><code>log.info(data)</code></td>
<td>将data显示为运行时调试信息</td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
</tr>
</tbody>
</table>
<h2 id="一些基础知识点"><a href="#一些基础知识点" class="headerlink" title="一些基础知识点"></a>一些基础知识点</h2><h3 id="x64下前6个参数不是保存在栈中，而是通过寄存器传值"><a href="#x64下前6个参数不是保存在栈中，而是通过寄存器传值" class="headerlink" title="x64下前6个参数不是保存在栈中，而是通过寄存器传值"></a>x64下前6个参数不是保存在栈中，而是通过寄存器传值</h3><p> <strong>64位汇编</strong></p>
<ul>
<li><p>当参数少于7个时， 参数从左到右放入寄存器: rdi, rsi, rdx, rcx, r8, r9。<br>当参数为7个以上时， 前 6 个与前面一样， 但后面的依次从 “右向左” 放入栈中，即和32位汇编一样。</p>
</li>
<li><p>参数个数大于 7 个的时候</p>
<ul>
<li>H(a, b, c, d, e, f, g, h);</li>
<li>a-&gt;%rdi, b-&gt;%rsi, c-&gt;%rdx, d-&gt;%rcx, e-&gt;%r8, f-&gt;%r9</li>
<li>h-&gt;8(%esp)</li>
<li>g-&gt;(%esp)</li>
<li>call H</li>
</ul>
</li>
</ul>
<h3 id="ELF文件加载到内存中的状态"><a href="#ELF文件加载到内存中的状态" class="headerlink" title="ELF文件加载到内存中的状态"></a>ELF文件加载到内存中的状态</h3><ul>
<li><p>BSS段：</p>
<ul>
<li>BSS段（bss segment）通常是指用来存放程序中未初始化的全局变量的一块内存区域。</li>
<li>BSS是英文Block Started by Symbol的简称。</li>
<li>BSS段属于静态内存分配。</li>
</ul>
</li>
<li><p>数据段：</p>
<ul>
<li>数据段（data segment）通常是指用来存放程序中已初始化的全局变量的一块内存区域。</li>
<li>数据段属于静态内存分配。</li>
</ul>
</li>
<li><p>代码段：</p>
<ul>
<li>代码段（code segment/text segment）通常是指用来存放程序执行代码的一块内存区域。</li>
<li>这部分区域的大小在程序运行前就已经确定，并且内存区域通常属于只读, 某些架构也允许代码段为可写，即允许修改程序。</li>
<li>在代码段中，也有可能包含一些只读的常数变量，例如字符串常量等。</li>
</ul>
</li>
<li><p>堆（heap）：</p>
<ul>
<li>堆是用于存放进程运行中被动态分配的内存段，它的大小并不固定，可动态扩张或缩减。</li>
<li>当进程调用malloc等函数分配内存时，新分配的内存就被动态添加到堆上（堆被扩张）；当利用free等函数释放内存时，被释放的内存从堆中被剔除（堆被缩减）</li>
</ul>
</li>
<li><p>栈(stack)：</p>
<ul>
<li>栈又称堆栈， 是用户存放程序临时创建的局部变量，也就是说我们函数括弧“{}”中定义的变量（但不包括static声明的变量，static意味着在数据段中存放变量）。</li>
<li>除此以外，在函数被调用时，其参数也会被压入发起调用的进程栈中，并且待到调用结束后，函数的返回值也会被存放回栈中。</li>
<li>由于栈的先进先出特点，所以栈特别方便用来保存/恢复调用现场。从这个意义上讲，我们可以把堆栈看成一个寄存、交换临时数据的内存区。</li>
</ul>
</li>
</ul>
<h2 id="确定缓冲区大小的peda方法："><a href="#确定缓冲区大小的peda方法：" class="headerlink" title="确定缓冲区大小的peda方法："></a>确定缓冲区大小的peda方法：</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">gdb-peda$</span> pattern_create 60</span><br><span class="line">'AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA'</span><br><span class="line"><span class="meta">gdb-peda$</span> run</span><br><span class="line">Starting program: /root/Desktop/ret2resolve/babystack</span><br><span class="line"></span><br><span class="line">Program received signal SIGALRM, Alarm clock.</span><br><span class="line"><span class="meta">AAA%</span>AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line"></span><br><span class="line">[----------------------------------registers-----------------------------------]</span><br><span class="line">EAX: 0x3d ('=')</span><br><span class="line">EBX: 0x0</span><br><span class="line">ECX: 0xffffd190 ("AAA%AAsAABAA$AAnAACAA-AA(AADAA;AA)AAEAAaAA0AAFAAbAA1AAGAAcAA\n\271\336", &lt;incomplete sequence \367&gt;)</span><br><span class="line">EDX: 0x40 ('@')</span><br><span class="line">ESI: 0xf7fa8000 --&gt; 0x1d5d8c</span><br><span class="line">EDI: 0x0</span><br><span class="line">EBP: 0x41304141 ('AA0A')</span><br><span class="line">ESP: 0xffffd1c0 ("bAA1AAGAAcAA\n\271\336", &lt;incomplete sequence \367&gt;)</span><br><span class="line">EIP: 0x41414641 ('AFAA')</span><br><span class="line">EFLAGS: 0x10286 (carry PARITY adjust zero SIGN trap INTERRUPT direction overflow)</span><br><span class="line">[-------------------------------------code-------------------------------------]</span><br><span class="line">Invalid $PC address: 0x41414641</span><br><span class="line">[------------------------------------stack-------------------------------------]</span><br><span class="line">0000| 0xffffd1c0 ("bAA1AAGAAcAA\n\271\336", &lt;incomplete sequence \367&gt;)</span><br><span class="line">0004| 0xffffd1c4 ("AAGAAcAA\n\271\336", &lt;incomplete sequence \367&gt;)</span><br><span class="line">0008| 0xffffd1c8 ("AcAA\n\271\336", &lt;incomplete sequence \367&gt;)</span><br><span class="line">0012| 0xffffd1cc --&gt; 0xf7deb90a (&lt;__libc_start_main+90&gt;:	and    ebx,0x2)</span><br><span class="line">0016| 0xffffd1d0 --&gt; 0xf7fa8000 --&gt; 0x1d5d8c</span><br><span class="line">0020| 0xffffd1d4 --&gt; 0xf7fa8000 --&gt; 0x1d5d8c</span><br><span class="line">0024| 0xffffd1d8 --&gt; 0x0</span><br><span class="line">0028| 0xffffd1dc --&gt; 0xf7deb9a1 (&lt;__libc_start_main+241&gt;:	add    esp,0x10)</span><br><span class="line">[------------------------------------------------------------------------------]</span><br><span class="line">Legend: code, data, rodata, value</span><br><span class="line">Stopped reason: SIGSEGV</span><br><span class="line">0x41414641 in ?? ()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">gdb-peda$</span> pattern_offset AFAA</span><br><span class="line">AFAA found at offset: 44</span><br><span class="line"><span class="meta">gdb-peda$</span></span><br></pre></td></tr></table></figure>
<h2 id="确定缓冲区大小的gef方法："><a href="#确定缓冲区大小的gef方法：" class="headerlink" title="确定缓冲区大小的gef方法："></a>确定缓冲区大小的gef方法：</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">gef➤  pattern create 200</span><br><span class="line">[+] Generating a pattern of 200 bytes</span><br><span class="line">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab</span><br><span class="line">[+] Saved as '$_gef0'</span><br><span class="line">gef➤  r</span><br><span class="line">Starting program: /root/Desktop/PWN/ret2_dl_runtime_resolve/main</span><br><span class="line">Welcome to XDCTF2015~!</span><br><span class="line">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxaabyaab</span><br><span class="line"></span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">[ Legend: Modified register | Code | Heap | Stack | String ]</span><br><span class="line">────────────────────────────────────────────────────────────────────────────[ registers ]────</span><br><span class="line"><span class="meta">$</span>eax   : 0xc9</span><br><span class="line"><span class="meta">$</span>ebx   : 0x0</span><br><span class="line"><span class="meta">$</span>ecx   : 0xffffd0ac  →  "aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]"</span><br><span class="line"><span class="meta">$</span>edx   : 0x100</span><br><span class="line"><span class="meta">$</span>esp   : 0xffffd120  →  "eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqa[...]"</span><br><span class="line"><span class="meta">$</span>ebp   : 0x62616163 ("caab"?)</span><br><span class="line"><span class="meta">$</span>esi   : 0xf7fa8000  →  0x001d5d8c</span><br><span class="line"><span class="meta">$</span>edi   : 0xffffd190  →  0xffffd1b0  →  0x00000001</span><br><span class="line"><span class="meta">$</span>eip   : 0x62616164 ("daab"?)</span><br><span class="line"><span class="meta">$</span>eflags: [zero carry PARITY adjust SIGN trap INTERRUPT direction overflow RESUME virtualx86 identification]</span><br><span class="line"><span class="meta">$</span>gs: 0x0063  $ds: 0x002b  $fs: 0x0000  $ss: 0x002b  $es: 0x002b  $cs: 0x0023</span><br><span class="line">────────────────────────────────────────────────────────────────────────────────[ stack ]────</span><br><span class="line">0xffffd120│+0x00: "eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqa[...]"	 ← $esp</span><br><span class="line">0xffffd124│+0x04: "faabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabra[...]"</span><br><span class="line">0xffffd128│+0x08: "gaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsa[...]"</span><br><span class="line">0xffffd12c│+0x0c: "haabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabta[...]"</span><br><span class="line">0xffffd130│+0x10: "iaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabua[...]"</span><br><span class="line">0xffffd134│+0x14: "jaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabva[...]"</span><br><span class="line">0xffffd138│+0x18: "kaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwa[...]"</span><br><span class="line">0xffffd13c│+0x1c: "laabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxa[...]"</span><br><span class="line">────────────────────────────────────────────────────────────────────────────[ code:i386 ]────</span><br><span class="line">[!] Cannot disassemble from $PC</span><br><span class="line">[!] Cannot access memory at address 0x62616164</span><br><span class="line">──────────────────────────────────────────────────────────────────────────────[ threads ]────</span><br><span class="line"><span class="meta">[#</span>0] Id 1, Name: "main", stopped, reason: SIGSEGV</span><br><span class="line">────────────────────────────────────────────────────────────────────────────────[ trace ]────</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">[ Legend: Modified register | Code | Heap | Stack | String ]</span><br><span class="line">────────────────────────────────────────────────────────────────────────────[ registers ]────</span><br><span class="line"><span class="meta">$</span>eax   : 0xc9</span><br><span class="line"><span class="meta">$</span>ebx   : 0x0</span><br><span class="line"><span class="meta">$</span>ecx   : 0xffffd0ac  →  "aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaama[...]"</span><br><span class="line"><span class="meta">$</span>edx   : 0x100</span><br><span class="line"><span class="meta">$</span>esp   : 0xffffd120  →  "eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqa[...]"</span><br><span class="line"><span class="meta">$</span>ebp   : 0x62616163 ("caab"?)</span><br><span class="line"><span class="meta">$</span>esi   : 0xf7fa8000  →  0x001d5d8c</span><br><span class="line"><span class="meta">$</span>edi   : 0xffffd190  →  0xffffd1b0  →  0x00000001</span><br><span class="line"><span class="meta">$</span>eip   : 0x62616164 ("daab"?)</span><br><span class="line"><span class="meta">$</span>eflags: [zero carry PARITY adjust SIGN trap INTERRUPT direction overflow RESUME virtualx86 identification]</span><br><span class="line"><span class="meta">$</span>gs: 0x0063  $ds: 0x002b  $fs: 0x0000  $ss: 0x002b  $es: 0x002b  $cs: 0x0023</span><br><span class="line">────────────────────────────────────────────────────────────────────────────────[ stack ]────</span><br><span class="line">0xffffd120│+0x00: "eaabfaabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqa[...]"	 ← $esp</span><br><span class="line">0xffffd124│+0x04: "faabgaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabra[...]"</span><br><span class="line">0xffffd128│+0x08: "gaabhaabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsa[...]"</span><br><span class="line">0xffffd12c│+0x0c: "haabiaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabta[...]"</span><br><span class="line">0xffffd130│+0x10: "iaabjaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabua[...]"</span><br><span class="line">0xffffd134│+0x14: "jaabkaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabva[...]"</span><br><span class="line">0xffffd138│+0x18: "kaablaabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwa[...]"</span><br><span class="line">0xffffd13c│+0x1c: "laabmaabnaaboaabpaabqaabraabsaabtaabuaabvaabwaabxa[...]"</span><br><span class="line">────────────────────────────────────────────────────────────────────────────[ code:i386 ]────</span><br><span class="line">[!] Cannot disassemble from $PC</span><br><span class="line">[!] Cannot access memory at address 0x62616164</span><br><span class="line">──────────────────────────────────────────────────────────────────────────────[ threads ]────</span><br><span class="line"><span class="meta">[#</span>0] Id 1, Name: "main", stopped, reason: SIGSEGV</span><br><span class="line">────────────────────────────────────────────────────────────────────────────────[ trace ]────</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">0x62616164 in ?? ()</span><br><span class="line"></span><br><span class="line">gef➤  pattern search 0x62616164</span><br><span class="line">[+] Searching '0x62616164'</span><br><span class="line">[+] Found at offset 112 (little-endian search) likely</span><br></pre></td></tr></table></figure>
<h2 id="使gef的调试信息输出到不同的终端窗口"><a href="#使gef的调试信息输出到不同的终端窗口" class="headerlink" title="使gef的调试信息输出到不同的终端窗口"></a>使gef的调试信息输出到不同的终端窗口</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span> tty       #这个命令查看当前打开的终端数量</span><br><span class="line">/dev/pts/0    #这个结果表示有一个终端窗口</span><br><span class="line">gef➤ gef config context.redirect /dev/pts/0     #命令设置将运行结果输出到0号终端窗口</span><br><span class="line">gef➤ gef config context.redirect ""     #恢复设置</span><br></pre></td></tr></table></figure>
<h2 id="objdump使用相关技巧"><a href="#objdump使用相关技巧" class="headerlink" title="objdump使用相关技巧"></a>objdump使用相关技巧</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">objdump -f test  显示test的文件头信息</span><br><span class="line"></span><br><span class="line">objdump -d test  反汇编test中的需要执行指令的那些section</span><br><span class="line"></span><br><span class="line">objdump -D test  与-d类似，但反汇编test中的所有section</span><br><span class="line"></span><br><span class="line">objdump -h test  显示test的Section Header信息</span><br><span class="line"></span><br><span class="line">objdump -x test  显示test的全部Header信息</span><br><span class="line"></span><br><span class="line">objdump -s test  除了显示test的全部Header信息，还显示他们对应的十六进制文件代码</span><br><span class="line"></span><br><span class="line">输出到txt文件objdump -s test.so&gt;test.txt</span><br><span class="line"></span><br><span class="line">同时可以用命nm,strace,gdb.</span><br></pre></td></tr></table></figure>
<h2 id="常用的查找偏移的办法"><a href="#常用的查找偏移的办法" class="headerlink" title="常用的查找偏移的办法"></a>常用的查找偏移的办法</h2><ul>
<li><p>strings工具</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/PWN/guess# strings -a -tx /lib/x86_64-linux-gnu/libc.so.6 | grep "environ"</span><br><span class="line">  142be __environ</span><br></pre></td></tr></table></figure>
</li>
<li><p>ROPgadget工具</p>
  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/PWN/guess# ROPgadget --binary /lib/x86_64-linux-gnu/libc.so.6 --only "__environ"</span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line"></span><br><span class="line">Unique gadgets found: 0</span><br><span class="line">root@kali:~/Desktop/PWN/guess# ROPgadget --binary easypwn  --only 'pop|ret'</span><br><span class="line">...</span><br><span class="line">root@kali:~/Desktop/PWN/guess# ROPgadget --binary easypwn  --only 'pop|ret' | grep 'ebx'</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
</li>
<li><p>目前感觉上面的两种工具都有自己的优点：</p>
<ul>
<li>strings工具更好的锁定libc文件中的字符串的位置，搜索速度更快</li>
<li>ROPgadget工具能够更好的锁定汇编代码的片段提供的信息更加详细，但搜索速度较慢</li>
</ul>
</li>
</ul>
<h2 id="gef工具与pwndbg调试工具区别"><a href="#gef工具与pwndbg调试工具区别" class="headerlink" title="gef工具与pwndbg调试工具区别"></a>gef工具与pwndbg调试工具区别</h2><ul>
<li>最近刚刚发现的这两个工具的一个不同之处，具体原因解释的可能不对，但这个现象是存在的。</li>
<li>遇到程序fork()或者其他什么能够产生另一个进程的程序的时候，gef不会直接跳转到这个进程去让你调试，如果你所下的断点包含在fork()子进程的代码部分里面，gef会直接执行，并不会在该位置停下，总结一下就是你的这个断点的执行效果不在当前进程的时候gef不能够帮你断下来，他会直接开了子进程，然后执行到该断点处继续执行，切记不会停下来，此时对于父进程而言，是gef正在调试的进程则会处在等待子进程相应返回的状态，待到子进程返回之后，父进程继续执行。换句话说，就是你的断点不在当前进程时，gef不会帮你断下来。如果父进程有wait() 函数等待子进程状态，而你在调试的时候是单步步过的call wait这句命令，那么gef会陷入阻塞状态等待子进程返回，而此时子进程又断了下来（因为单步执行），gef就会一直等这个暂停的进程，使用gdb，attach到该子进程后使其继续执行，父进程的gef等待状态在收到子进程结束的信息后会结束等待状态。</li>
<li>然而pwndbg则会直接帮你跳转到子进程去，在断点的位置停下，并且结束后自动返回父进程进行调试</li>
</ul>
<h2 id="GDB调试技巧"><a href="#GDB调试技巧" class="headerlink" title="GDB调试技巧"></a>GDB调试技巧</h2><img src="/2019/01/14/PWN-学习笔记/gdbtiaoshi.png" title="PWN-学习笔记">
<h2 id="汇编语言ret后带一个参数的执行方式"><a href="#汇编语言ret后带一个参数的执行方式" class="headerlink" title="汇编语言ret后带一个参数的执行方式"></a>汇编语言ret后带一个参数的执行方式</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">pwndbg&gt;</span> si</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd07c —▸ 0xf7eb8470 (read) ◂— push   esi</span><br><span class="line"> EIP  0xf7fea35b (_dl_runtime_resolve+27) ◂— ret    0xc</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line"></span><br><span class="line">   0xf7fea350 &lt;_dl_runtime_resolve+16&gt;    pop    edx</span><br><span class="line">   0xf7fea351 &lt;_dl_runtime_resolve+17&gt;    mov    ecx, dword ptr [esp]</span><br><span class="line">   0xf7fea354 &lt;_dl_runtime_resolve+20&gt;    mov    dword ptr [esp], eax</span><br><span class="line">   0xf7fea357 &lt;_dl_runtime_resolve+23&gt;    mov    eax, dword ptr [esp + 4]</span><br><span class="line"> ► 0xf7fea35b &lt;_dl_runtime_resolve+27&gt;    ret    0xc</span><br><span class="line">    ↓</span><br><span class="line">   0xf7eb8470 &lt;read&gt;                      push   esi</span><br><span class="line">   0xf7eb8471 &lt;read+1&gt;                    push   ebx</span><br><span class="line">   0xf7eb8472 &lt;read+2&gt;                    sub    esp, 0x14</span><br><span class="line">   0xf7eb8475 &lt;read+5&gt;                    mov    ebx, dword ptr [esp + 0x20]</span><br><span class="line">   0xf7eb8479 &lt;read+9&gt;                    mov    ecx, dword ptr [esp + 0x24]</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd07c —▸ 0xf7eb8470 (read) ◂— push   esi</span><br><span class="line">01:0004│      0xffffd080 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">02:0008│      0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">03:000c│      0xffffd088 ◂— 0x8</span><br><span class="line">04:0010│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">05:0014│      0xffffd090 ◂— 0x0</span><br><span class="line">06:0018│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">07:001c│      0xffffd098 ◂— 0x100</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7eb8470 read</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">__GI___libc_read (fd=0x0, buf=0xffffd0ac, nbytes=0x100) at ../sysdeps/unix/sysv/linux/read.c:26</span><br><span class="line">26	../sysdeps/unix/sysv/linux/read.c: No such file or directory.</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line"> EIP  0xf7eb8470 (read) ◂— push   esi</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0xf7eb8470 &lt;read&gt;       push   esi</span><br><span class="line">   0xf7eb8471 &lt;read+1&gt;     push   ebx</span><br><span class="line">   0xf7eb8472 &lt;read+2&gt;     sub    esp, 0x14</span><br><span class="line">   0xf7eb8475 &lt;read+5&gt;     mov    ebx, dword ptr [esp + 0x20]</span><br><span class="line">   0xf7eb8479 &lt;read+9&gt;     mov    ecx, dword ptr [esp + 0x24]</span><br><span class="line">   0xf7eb847d &lt;read+13&gt;    mov    edx, dword ptr [esp + 0x28]</span><br><span class="line">   0xf7eb8481 &lt;read+17&gt;    mov    eax, dword ptr gs:[0xc]</span><br><span class="line">   0xf7eb8487 &lt;read+23&gt;    test   eax, eax</span><br><span class="line">   0xf7eb8489 &lt;read+25&gt;    jne    read+56 &lt;0xf7eb84a8&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7eb84a8 &lt;read+56&gt;    mov    dword ptr [esp + 0xc], edx</span><br><span class="line">   0xf7eb84ac &lt;read+60&gt;    mov    dword ptr [esp + 8], ecx</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">01:0004│      0xffffd090 ◂— 0x0</span><br><span class="line">02:0008│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">03:000c│      0xffffd098 ◂— 0x100</span><br><span class="line">04:0010│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">05:0014│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">06:0018│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">07:001c│      0xffffd0a8 —▸ 0xf7fce410 —▸ 0x80482d9 ◂— inc    edi /* 'GLIBC_2.0' */</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7eb8470 read</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br></pre></td></tr></table></figure>
<ul>
<li>上面的内容是一个简单的例子，<strong>ret 0xc</strong> 的执行效果，首先从栈顶弹出一个值最为返回地址，去相应的位置执行，然后从栈顶弹出偏移0xc的内容，或者理解为 <strong>esp - 0xc</strong>，此程序为32位系统，则效果为从栈顶弹出三个值</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; b main</span><br><span class="line">pwndbg&gt; si</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd090 ◂— 0x0</span><br><span class="line"> EIP  0x8048514 (vuln+41) —▸ 0xfffe87e8 ◂— 0x0</span><br><span class="line">─────────────────────────────────────────[ DISASM ]──────────────────────────────────────────</span><br><span class="line">   0x8048509 &lt;vuln+30&gt;    push   0x100</span><br><span class="line">   0x804850e &lt;vuln+35&gt;    lea    eax, [ebp - 0x6c]</span><br><span class="line">   0x8048511 &lt;vuln+38&gt;    push   eax</span><br><span class="line">   0x8048512 &lt;vuln+39&gt;    push   0</span><br><span class="line"> ► 0x8048514 &lt;vuln+41&gt;    call   read@plt &lt;0x80483a0&gt;</span><br><span class="line">        fd: 0x0</span><br><span class="line">        buf: 0xffffd0ac ◂— 0x1</span><br><span class="line">        nbytes: 0x100</span><br><span class="line"></span><br><span class="line">   0x8048519 &lt;vuln+46&gt;    add    esp, 0x10</span><br><span class="line">   0x804851c &lt;vuln+49&gt;    nop</span><br><span class="line">   0x804851d &lt;vuln+50&gt;    leave</span><br><span class="line">   0x804851e &lt;vuln+51&gt;    ret</span><br><span class="line"></span><br><span class="line">   0x804851f &lt;main&gt;       lea    ecx, [esp + 4]</span><br><span class="line">   0x8048523 &lt;main+4&gt;     and    esp, 0xfffffff0</span><br><span class="line">──────────────────────────────────────────[ STACK ]──────────────────────────────────────────</span><br><span class="line">00:0000│ esp      0xffffd090 ◂— 0x0</span><br><span class="line">01:0004│          0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">02:0008│          0xffffd098 ◂— 0x100</span><br><span class="line">03:000c│          0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">04:0010│          0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">05:0014│          0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">06:0018│          0xffffd0a8 —▸ 0xf7fce410 —▸ 0x80482d9 ◂— inc    edi /* &apos;GLIBC_2.0&apos; */</span><br><span class="line">07:001c│ eax ecx  0xffffd0ac ◂— 0x1</span><br><span class="line">────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────</span><br><span class="line"> ► f 0  80483a0 read@plt</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">0x080483a0 in read@plt ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line"> EIP  0x80483a0 (read@plt) ◂— jmp    dword ptr [0x804a010]</span><br><span class="line">─────────────────────────────────────────[ DISASM ]──────────────────────────────────────────</span><br><span class="line"> ► 0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">──────────────────────────────────────────[ STACK ]──────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">01:0004│      0xffffd090 ◂— 0x0</span><br><span class="line">02:0008│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">03:000c│      0xffffd098 ◂— 0x100</span><br><span class="line">04:0010│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">05:0014│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">06:0018│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">07:001c│      0xffffd0a8 —▸ 0xf7fce410 —▸ 0x80482d9 ◂— inc    edi /* &apos;GLIBC_2.0&apos; */</span><br><span class="line">────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────</span><br><span class="line"> ► f 0  80483a0 read@plt</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">pwndbg&gt; si</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line"> EIP  0x80483a0 (read@plt) ◂— jmp    dword ptr [0x804a010]</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">01:0004│      0xffffd090 ◂— 0x0</span><br><span class="line">02:0008│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">03:000c│      0xffffd098 ◂— 0x100</span><br><span class="line">04:0010│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">05:0014│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">06:0018│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">07:001c│      0xffffd0a8 —▸ 0xf7fce410 —▸ 0x80482d9 ◂— inc    edi /* &apos;GLIBC_2.0&apos; */</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  80483a6 read@plt+6</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">0x080483a6 in read@plt ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line"> EIP  0x80483a6 (read@plt+6) ◂— push   8</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line"> ► 0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">01:0004│      0xffffd090 ◂— 0x0</span><br><span class="line">02:0008│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">03:000c│      0xffffd098 ◂— 0x100</span><br><span class="line">04:0010│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">05:0014│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">06:0018│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">07:001c│      0xffffd0a8 —▸ 0xf7fce410 —▸ 0x80482d9 ◂— inc    edi /* &apos;GLIBC_2.0&apos; */</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  80483a6 read@plt+6</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">pwndbg&gt;</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line"> EIP  0x80483a6 (read@plt+6) ◂— push   8</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line"> ► 0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">01:0004│      0xffffd090 ◂— 0x0</span><br><span class="line">02:0008│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">03:000c│      0xffffd098 ◂— 0x100</span><br><span class="line">04:0010│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">05:0014│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">06:0018│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">07:001c│      0xffffd0a8 —▸ 0xf7fce410 —▸ 0x80482d9 ◂— inc    edi /* &apos;GLIBC_2.0&apos; */</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  80483ab read@plt+11</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">0x080483ab in read@plt ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd088 ◂— 0x8</span><br><span class="line"> EIP  0x80483ab (read@plt+11) —▸ 0xffffd0e9 ◂— 0x67ffffd1</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line"> ► 0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd088 ◂— 0x8</span><br><span class="line">01:0004│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">02:0008│      0xffffd090 ◂— 0x0</span><br><span class="line">03:000c│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">04:0010│      0xffffd098 ◂— 0x100</span><br><span class="line">05:0014│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">06:0018│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">07:001c│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  80483ab read@plt+11</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">pwndbg&gt; x/10i 0x8048380</span><br><span class="line">   0x8048380:	push   DWORD PTR ds:0x804a004</span><br><span class="line">   0x8048386:	jmp    DWORD PTR ds:0x804a008</span><br><span class="line">   0x804838c:	add    BYTE PTR [eax],al</span><br><span class="line">   0x804838e:	add    BYTE PTR [eax],al</span><br><span class="line">   0x8048390 &lt;setbuf@plt&gt;:	jmp    DWORD PTR ds:0x804a00c</span><br><span class="line">   0x8048396 &lt;setbuf@plt+6&gt;:	push   0x0</span><br><span class="line">   0x804839b &lt;setbuf@plt+11&gt;:	jmp    0x8048380</span><br><span class="line">   0x80483a0 &lt;read@plt&gt;:	jmp    DWORD PTR ds:0x804a010</span><br><span class="line">   0x80483a6 &lt;read@plt+6&gt;:	push   0x8</span><br><span class="line">=&gt; 0x80483ab &lt;read@plt+11&gt;:	jmp    0x8048380</span><br><span class="line">pwndbg&gt; x/xw 0x804a004</span><br><span class="line">0x804a004:	0xf7ffd940</span><br><span class="line">pwndbg&gt;</span><br><span class="line">0x804a008:	0xf7fea340</span><br><span class="line">pwndbg&gt; si</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd088 ◂— 0x8</span><br><span class="line"> EIP  0x80483ab (read@plt+11) —▸ 0xffffd0e9 ◂— 0x67ffffd1</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line"> ► 0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line"></span><br><span class="line">   0xf7fea350 &lt;_dl_runtime_resolve+16&gt;    pop    edx</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd088 ◂— 0x8</span><br><span class="line">01:0004│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">02:0008│      0xffffd090 ◂— 0x0</span><br><span class="line">03:000c│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">04:0010│      0xffffd098 ◂— 0x100</span><br><span class="line">05:0014│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">06:0018│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">07:001c│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  8048380</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">0x08048380 in ?? ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd088 ◂— 0x8</span><br><span class="line"> EIP  0x8048380 ◂— push   dword ptr [0x804a004]</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line"> ► 0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd088 ◂— 0x8</span><br><span class="line">01:0004│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">02:0008│      0xffffd090 ◂— 0x0</span><br><span class="line">03:000c│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">04:0010│      0xffffd098 ◂— 0x100</span><br><span class="line">05:0014│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">06:0018│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">07:001c│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  8048380</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">pwndbg&gt;</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd088 ◂— 0x8</span><br><span class="line"> EIP  0x8048380 ◂— push   dword ptr [0x804a004]</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line"> ► 0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd088 ◂— 0x8</span><br><span class="line">01:0004│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">02:0008│      0xffffd090 ◂— 0x0</span><br><span class="line">03:000c│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">04:0010│      0xffffd098 ◂— 0x100</span><br><span class="line">05:0014│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">06:0018│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">07:001c│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  8048386</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">0x08048386 in ?? ()</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line"> EIP  0x8048386 ◂— jmp    dword ptr [0x804a008]</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line"> ► 0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">01:0004│      0xffffd088 ◂— 0x8</span><br><span class="line">02:0008│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">03:000c│      0xffffd090 ◂— 0x0</span><br><span class="line">04:0010│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">05:0014│      0xffffd098 ◂— 0x100</span><br><span class="line">06:0018│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">07:001c│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0  8048386</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">pwndbg&gt;</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line"> EIP  0x8048386 ◂— jmp    dword ptr [0x804a008]</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line"> ► 0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">01:0004│      0xffffd088 ◂— 0x8</span><br><span class="line">02:0008│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">03:000c│      0xffffd090 ◂— 0x0</span><br><span class="line">04:0010│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">05:0014│      0xffffd098 ◂— 0x100</span><br><span class="line">06:0018│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">07:001c│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7fea340 _dl_runtime_resolve</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">_dl_runtime_resolve () at ../sysdeps/i386/dl-trampoline.S:35</span><br><span class="line">35	../sysdeps/i386/dl-trampoline.S: No such file or directory.</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line"> EIP  0xf7fea340 (_dl_runtime_resolve) ◂— push   eax</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0x80483a0  &lt;read@plt&gt;                  jmp    dword ptr [_GLOBAL_OFFSET_TABLE_+16] &lt;0x804a010&gt;</span><br><span class="line"></span><br><span class="line">   0x80483a6  &lt;read@plt+6&gt;                push   8</span><br><span class="line">   0x80483ab  &lt;read@plt+11&gt;               jmp    0x8048380</span><br><span class="line">    ↓</span><br><span class="line">   0x8048380                              push   dword ptr [_GLOBAL_OFFSET_TABLE_+4] &lt;0x804a004&gt;</span><br><span class="line">   0x8048386                              jmp    dword ptr [0x804a008] &lt;0xf7fea340&gt;</span><br><span class="line">    ↓</span><br><span class="line"> ► 0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">01:0004│      0xffffd088 ◂— 0x8</span><br><span class="line">02:0008│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">03:000c│      0xffffd090 ◂— 0x0</span><br><span class="line">04:0010│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">05:0014│      0xffffd098 ◂— 0x100</span><br><span class="line">06:0018│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">07:001c│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7fea340 _dl_runtime_resolve</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line"></span><br><span class="line">pwndbg&gt; b *0xf7fea350</span><br><span class="line">Breakpoint 3 at 0xf7fea350: file ../sysdeps/i386/dl-trampoline.S, line 44.</span><br><span class="line">pwndbg&gt; c</span><br><span class="line">Continuing.</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xf7ffd940 ◂— 0x0</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0x8</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd078 —▸ 0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EIP  0xf7fea34b (_dl_runtime_resolve+11) —▸ 0xffa1a0e8 ◂— 0xffa1a0e8</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0xf7fea340 &lt;_dl_runtime_resolve&gt;       push   eax</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line"> ► 0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line">        arg[0]: 0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line">        arg[1]: 0xffffd0ac ◂— 0x1</span><br><span class="line"></span><br><span class="line">   0xf7fea350 &lt;_dl_runtime_resolve+16&gt;    pop    edx</span><br><span class="line">   0xf7fea351 &lt;_dl_runtime_resolve+17&gt;    mov    ecx, dword ptr [esp]</span><br><span class="line">   0xf7fea354 &lt;_dl_runtime_resolve+20&gt;    mov    dword ptr [esp], eax</span><br><span class="line">   0xf7fea357 &lt;_dl_runtime_resolve+23&gt;    mov    eax, dword ptr [esp + 4]</span><br><span class="line">   0xf7fea35b &lt;_dl_runtime_resolve+27&gt;    ret    0xc</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd078 —▸ 0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line">01:0004│      0xffffd07c —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">... ↓</span><br><span class="line">03:000c│      0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">04:0010│      0xffffd088 ◂— 0x8</span><br><span class="line">05:0014│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">06:0018│      0xffffd090 ◂— 0x0</span><br><span class="line">07:001c│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7fea350 _dl_runtime_resolve+16</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line"></span><br><span class="line">Breakpoint 3, _dl_runtime_resolve () at ../sysdeps/i386/dl-trampoline.S:44</span><br><span class="line">44	in ../sysdeps/i386/dl-trampoline.S</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xf7eb8470 (read) ◂— push   esi</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xf7dd9eb8 ◂— 0x21b2</span><br><span class="line"> EDX  0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd078 —▸ 0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EIP  0xf7fea350 (_dl_runtime_resolve+16) ◂— pop    edx</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0xf7fea341 &lt;_dl_runtime_resolve+1&gt;     push   ecx</span><br><span class="line">   0xf7fea342 &lt;_dl_runtime_resolve+2&gt;     push   edx</span><br><span class="line">   0xf7fea343 &lt;_dl_runtime_resolve+3&gt;     mov    edx, dword ptr [esp + 0x10]</span><br><span class="line">   0xf7fea347 &lt;_dl_runtime_resolve+7&gt;     mov    eax, dword ptr [esp + 0xc]</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line"></span><br><span class="line"> ► 0xf7fea350 &lt;_dl_runtime_resolve+16&gt;    pop    edx</span><br><span class="line">   0xf7fea351 &lt;_dl_runtime_resolve+17&gt;    mov    ecx, dword ptr [esp]</span><br><span class="line">   0xf7fea354 &lt;_dl_runtime_resolve+20&gt;    mov    dword ptr [esp], eax</span><br><span class="line">   0xf7fea357 &lt;_dl_runtime_resolve+23&gt;    mov    eax, dword ptr [esp + 4]</span><br><span class="line">   0xf7fea35b &lt;_dl_runtime_resolve+27&gt;    ret    0xc</span><br><span class="line">    ↓</span><br><span class="line">   0xf7eb8470 &lt;read&gt;                      push   esi</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd078 —▸ 0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line">01:0004│      0xffffd07c —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">... ↓</span><br><span class="line">03:000c│      0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">04:0010│      0xffffd088 ◂— 0x8</span><br><span class="line">05:0014│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">06:0018│      0xffffd090 ◂— 0x0</span><br><span class="line">07:001c│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7fea350 _dl_runtime_resolve+16</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">Breakpoint *0xf7fea350</span><br><span class="line">pwndbg&gt; x/xw 0x8048a010</span><br><span class="line">0x8048a010:	Cannot access memory at address 0x8048a010</span><br><span class="line">pwndbg&gt; x/xw 0x804a010</span><br><span class="line">0x804a010:	0xf7eb8470</span><br><span class="line"></span><br><span class="line">pwndbg&gt; c</span><br><span class="line">......</span><br><span class="line"></span><br><span class="line">pwndbg&gt; si</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd07c —▸ 0xf7eb8470 (read) ◂— push   esi</span><br><span class="line"> EIP  0xf7fea35b (_dl_runtime_resolve+27) ◂— ret    0xc</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">   0xf7fea34b &lt;_dl_runtime_resolve+11&gt;    call   _dl_fixup &lt;0xf7fe44f0&gt;</span><br><span class="line"></span><br><span class="line">   0xf7fea350 &lt;_dl_runtime_resolve+16&gt;    pop    edx</span><br><span class="line">   0xf7fea351 &lt;_dl_runtime_resolve+17&gt;    mov    ecx, dword ptr [esp]</span><br><span class="line">   0xf7fea354 &lt;_dl_runtime_resolve+20&gt;    mov    dword ptr [esp], eax</span><br><span class="line">   0xf7fea357 &lt;_dl_runtime_resolve+23&gt;    mov    eax, dword ptr [esp + 4]</span><br><span class="line"> ► 0xf7fea35b &lt;_dl_runtime_resolve+27&gt;    ret    0xc</span><br><span class="line">    ↓</span><br><span class="line">   0xf7eb8470 &lt;read&gt;                      push   esi</span><br><span class="line">   0xf7eb8471 &lt;read+1&gt;                    push   ebx</span><br><span class="line">   0xf7eb8472 &lt;read+2&gt;                    sub    esp, 0x14</span><br><span class="line">   0xf7eb8475 &lt;read+5&gt;                    mov    ebx, dword ptr [esp + 0x20]</span><br><span class="line">   0xf7eb8479 &lt;read+9&gt;                    mov    ecx, dword ptr [esp + 0x24]</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd07c —▸ 0xf7eb8470 (read) ◂— push   esi</span><br><span class="line">01:0004│      0xffffd080 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">02:0008│      0xffffd084 —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">03:000c│      0xffffd088 ◂— 0x8</span><br><span class="line">04:0010│      0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">05:0014│      0xffffd090 ◂— 0x0</span><br><span class="line">06:0018│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">07:001c│      0xffffd098 ◂— 0x100</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7eb8470 read</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">__GI___libc_read (fd=0x0, buf=0xffffd0ac, nbytes=0x100) at ../sysdeps/unix/sysv/linux/read.c:26</span><br><span class="line">26	../sysdeps/unix/sysv/linux/read.c: No such file or directory.</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ REGISTERS ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> EAX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EBX  0x0</span><br><span class="line"> ECX  0xffffd0ac ◂— 0x1</span><br><span class="line"> EDX  0xf7fa989c (_IO_stdfile_0_lock) ◂— 0x0</span><br><span class="line"> EDI  0xffffd190 —▸ 0xffffd1b0 ◂— 0x1</span><br><span class="line"> ESI  0xf7fa8000 (_GLOBAL_OFFSET_TABLE_) ◂— 0x1d5d8c</span><br><span class="line"> EBP  0xffffd118 —▸ 0xffffd198 ◂— 0x0</span><br><span class="line"> ESP  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line"> EIP  0xf7eb8470 (read) ◂— push   esi</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ DISASM ]─────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► 0xf7eb8470 &lt;read&gt;       push   esi</span><br><span class="line">   0xf7eb8471 &lt;read+1&gt;     push   ebx</span><br><span class="line">   0xf7eb8472 &lt;read+2&gt;     sub    esp, 0x14</span><br><span class="line">   0xf7eb8475 &lt;read+5&gt;     mov    ebx, dword ptr [esp + 0x20]</span><br><span class="line">   0xf7eb8479 &lt;read+9&gt;     mov    ecx, dword ptr [esp + 0x24]</span><br><span class="line">   0xf7eb847d &lt;read+13&gt;    mov    edx, dword ptr [esp + 0x28]</span><br><span class="line">   0xf7eb8481 &lt;read+17&gt;    mov    eax, dword ptr gs:[0xc]</span><br><span class="line">   0xf7eb8487 &lt;read+23&gt;    test   eax, eax</span><br><span class="line">   0xf7eb8489 &lt;read+25&gt;    jne    read+56 &lt;0xf7eb84a8&gt;</span><br><span class="line">    ↓</span><br><span class="line">   0xf7eb84a8 &lt;read+56&gt;    mov    dword ptr [esp + 0xc], edx</span><br><span class="line">   0xf7eb84ac &lt;read+60&gt;    mov    dword ptr [esp + 8], ecx</span><br><span class="line">─────────────────────────────────────────────────────────────────────────────────────────[ STACK ]──────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line">00:0000│ esp  0xffffd08c —▸ 0x8048519 (vuln+46) ◂— add    esp, 0x10</span><br><span class="line">01:0004│      0xffffd090 ◂— 0x0</span><br><span class="line">02:0008│      0xffffd094 —▸ 0xffffd0ac ◂— 0x1</span><br><span class="line">03:000c│      0xffffd098 ◂— 0x100</span><br><span class="line">04:0010│      0xffffd09c —▸ 0xf7ffd940 ◂— 0x0</span><br><span class="line">05:0014│      0xffffd0a0 —▸ 0xffffd0d4 —▸ 0xf7ddf728 ◂— 0x147a</span><br><span class="line">06:0018│      0xffffd0a4 —▸ 0xf7ffdaf8 —▸ 0xf7ffda9c —▸ 0xf7fce3e0 —▸ 0xf7ffd940 ◂— ...</span><br><span class="line">07:001c│      0xffffd0a8 —▸ 0xf7fce410 —▸ 0x80482d9 ◂— inc    edi /* &apos;GLIBC_2.0&apos; */</span><br><span class="line">───────────────────────────────────────────────────────────────────────────────────────[ BACKTRACE ]────────────────────────────────────────────────────────────────────────────────────────</span><br><span class="line"> ► f 0 f7eb8470 read</span><br><span class="line">   f 1  8048519 vuln+46</span><br><span class="line">   f 2  80485a7 main+136</span><br><span class="line">   f 3 f7deb9a1 __libc_start_main+241</span><br><span class="line">pwndbg&gt;</span><br></pre></td></tr></table></figure>
<h1 id="ROP-Return-Oriented-Programming"><a href="#ROP-Return-Oriented-Programming" class="headerlink" title="ROP(Return Oriented Programming)"></a>ROP(Return Oriented Programming)</h1><p>参考链接：<a href="https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/basic_rop/" target="_blank" rel="noopener">https://ctf-wiki.github.io/ctf-wiki/pwn/stackoverflow/basic_rop/</a></p>
<blockquote>
<p>按照ctf_wiki上的顺序,逐步深入的学习</p>
</blockquote>
<h2 id="基本ROP"><a href="#基本ROP" class="headerlink" title="基本ROP"></a>基本ROP</h2><ul>
<li><h3 id="ret2text-ret2syscall-ret2shellcode-ret2libc"><a href="#ret2text-ret2syscall-ret2shellcode-ret2libc" class="headerlink" title="ret2text,ret2syscall,ret2shellcode,ret2libc"></a>ret2text,ret2syscall,ret2shellcode,ret2libc</h3><ul>
<li>可以参考天舒的：<a href="https://blog.csdn.net/weixin_40850881/article/details/80216764" target="_blank" rel="noopener">https://blog.csdn.net/weixin_40850881/article/details/80216764</a></li>
<li>我自己的博客：</li>
</ul>
</li>
<li><h3 id="ret2resolve"><a href="#ret2resolve" class="headerlink" title="ret2resolve"></a>ret2resolve</h3><h4 id="使用readelf查看动态段-dynamic-的信息"><a href="#使用readelf查看动态段-dynamic-的信息" class="headerlink" title="使用readelf查看动态段  .dynamic  的信息"></a>使用readelf查看动态段  .dynamic  的信息</h4>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/ret2resolve# readelf -d babystack</span><br><span class="line"></span><br><span class="line">Dynamic section at offset 0xf14 contains 24 entries:</span><br><span class="line">  Tag        Type                         Name/Value</span><br><span class="line"> 0x00000001 (NEEDED)                     Shared library: [libc.so.6]</span><br><span class="line"> 0x0000000c (INIT)                       0x80482c8</span><br><span class="line"> 0x0000000d (FINI)                       0x80484f4</span><br><span class="line"> 0x00000019 (INIT_ARRAY)                 0x8049f08</span><br><span class="line"> 0x0000001b (INIT_ARRAYSZ)               4 (bytes)</span><br><span class="line"> 0x0000001a (FINI_ARRAY)                 0x8049f0c</span><br><span class="line"> 0x0000001c (FINI_ARRAYSZ)               4 (bytes)</span><br><span class="line"> 0x6ffffef5 (GNU_HASH)                   0x80481ac</span><br><span class="line"> 0x00000005 (STRTAB)                     0x804822c</span><br><span class="line"> 0x00000006 (SYMTAB)                     0x80481cc</span><br><span class="line"> 0x0000000a (STRSZ)                      80 (bytes)</span><br><span class="line"> 0x0000000b (SYMENT)                     16 (bytes)</span><br><span class="line"> 0x00000015 (DEBUG)                      0x0</span><br><span class="line"> 0x00000003 (PLTGOT)                     0x804a000</span><br><span class="line"> 0x00000002 (PLTRELSZ)                   24 (bytes)</span><br><span class="line"> 0x00000014 (PLTREL)                     REL</span><br><span class="line"> 0x00000017 (JMPREL)                     0x80482b0</span><br><span class="line"> 0x00000011 (REL)                        0x80482a8</span><br><span class="line"> 0x00000012 (RELSZ)                      8 (bytes)</span><br><span class="line"> 0x00000013 (RELENT)                     8 (bytes)</span><br><span class="line"> 0x6ffffffe (VERNEED)                    0x8048288</span><br><span class="line"> 0x6fffffff (VERNEEDNUM)                 1</span><br><span class="line"> 0x6ffffff0 (VERSYM)                     0x804827c</span><br><span class="line"> 0x00000000 (NULL)                       0x0</span><br></pre></td></tr></table></figure>
<p>  <strong>JMPREL</strong>中保存的是.rel.plt表中的信息</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000017 (JMPREL)                     0x80482b0</span><br></pre></td></tr></table></figure>
<p>  <strong>PLTRELSZ</strong>是.rel.plt表的大小为24字节</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000002 (PLTRELSZ)                   24 (bytes)</span><br></pre></td></tr></table></figure>
<p>  <strong>RELENT</strong>为每个.rel.plt表项的大小为8字节</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x00000013 (RELENT)                     8 (bytes)</span><br></pre></td></tr></table></figure>
<p>  这些表项为ELF32_Rel类型的数据结构。其中r_offset是该函数在got表中的位置，r_info为其类型和符号序号。</p>
  <figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint32_t</span> Elf32_Addr;</span><br><span class="line"><span class="keyword">typedef</span> <span class="keyword">uint32_t</span> Elf32_Word;</span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span></span></span><br><span class="line"><span class="class">&#123;</span></span><br><span class="line">  Elf32_Addr    r_offset;               <span class="comment">/* Address */</span></span><br><span class="line">  Elf32_Word    r_info;                 <span class="comment">/* Relocation type and symbol index */</span></span><br><span class="line">&#125; Elf32_Rel;</span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ELF32_R_SYM(val) ((val) &gt;&gt; 8)</span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">define</span> ELF32_R_TYPE(val) ((val) &amp; 0xff)</span></span><br></pre></td></tr></table></figure>
<h4 id="查看-rel-plt-表中的信息，使用命令readelf-r-babystack"><a href="#查看-rel-plt-表中的信息，使用命令readelf-r-babystack" class="headerlink" title="查看  .rel.plt  表中的信息，使用命令readelf -r babystack"></a>查看  .rel.plt  表中的信息，使用命令<code>readelf -r babystack</code></h4>  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">root@kali:~/Desktop/ret2resolve# readelf -r babystack</span><br><span class="line"></span><br><span class="line">Relocation section '.rel.dyn' at offset 0x2a8 contains 1 entry:</span><br><span class="line"> Offset     Info    Type            Sym.Value  Sym. Name</span><br><span class="line">08049ffc  00000306 R_386_GLOB_DAT    00000000   __gmon_start__</span><br><span class="line"></span><br><span class="line">Relocation section '.rel.plt' at offset 0x2b0 contains 3 entries:</span><br><span class="line"> Offset     Info    Type            Sym.Value  Sym. Name</span><br><span class="line">0804a00c  00000107 R_386_JUMP_SLOT   00000000   read@GLIBC_2.0</span><br><span class="line">0804a010  00000207 R_386_JUMP_SLOT   00000000   alarm@GLIBC_2.0</span><br><span class="line">0804a014  00000407 R_386_JUMP_SLOT   00000000   __libc_start_main@GLIBC_2.0</span><br></pre></td></tr></table></figure>
<p>  <strong>r_info</strong>为0x107，其中1表示read在符号表SYMTAB中的偏移为1,7表示为<strong>R_386_JUMP_SLOT</strong>类型，这一项用于检查，保持为7即可。我们前面看到的函数字符串就是通过在SYMTAB中的偏移来找到的。</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">gef➤  x/30i read</span><br><span class="line">   0x8048300 &lt;read@plt&gt;:	jmp    DWORD PTR ds:0x804a00c</span><br><span class="line">   0x8048306 &lt;read@plt+6&gt;:	push   0x0</span><br><span class="line">   0x804830b &lt;read@plt+11&gt;:	jmp    0x80482f0</span><br><span class="line">   0x8048310 &lt;alarm@plt&gt;:	jmp    DWORD PTR ds:0x804a010</span><br><span class="line">   0x8048316 &lt;alarm@plt+6&gt;:	push   0x8</span><br><span class="line">   0x804831b &lt;alarm@plt+11&gt;:	jmp    0x80482f0</span><br><span class="line">   0x8048320 &lt;__libc_start_main@plt&gt;:	jmp    DWORD PTR ds:0x804a014</span><br><span class="line">   0x8048326 &lt;__libc_start_main@plt+6&gt;:	push   0x10</span><br><span class="line">   0x804832b &lt;__libc_start_main@plt+11&gt;:	jmp    0x80482f0</span><br><span class="line">   0x8048330 &lt;__gmon_start__@plt&gt;:	jmp    DWORD PTR ds:0x8049ffc</span><br><span class="line">   0x8048336 &lt;__gmon_start__@plt+6&gt;:	xchg   ax,ax</span><br><span class="line">   0x8048338:	Cannot access memory at address 0x8048338</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="中级ROP"><a href="#中级ROP" class="headerlink" title="中级ROP"></a>中级ROP</h2><ul>
<li><h3 id="ret2-libc-csu-init"><a href="#ret2-libc-csu-init" class="headerlink" title="ret2__libc_csu_init"></a>ret2__libc_csu_init</h3><ul>
<li>参考我的博客：<a href="https://blog.csdn.net/aptx4869_li/article/details/81322632" target="_blank" rel="noopener">https://blog.csdn.net/aptx4869_li/article/details/81322632</a></li>
</ul>
</li>
<li><h3 id="BROP"><a href="#BROP" class="headerlink" title="BROP"></a>BROP</h3><ul>
<li>详细内容参见ctf-wiki上的讲解，关于这种利用方式的脚本的理解在我自己做题时的哪个脚本里面</li>
</ul>
</li>
</ul>
<h2 id="高级ROP"><a href="#高级ROP" class="headerlink" title="高级ROP"></a>高级ROP</h2><h1 id="堆溢出利用"><a href="#堆溢出利用" class="headerlink" title="堆溢出利用"></a>堆溢出利用</h1><ul>
<li><p>什么是堆：</p>
<ul>
<li>堆可以提供动态分配的内存，允许程序申请大小未知的内存。堆其实就是程序虚拟地址空间的一块连续的线性区域，它由低地址向高地址方向增长。<br>对于不同的应用来说，由于内存的需求各不相同等特性，因此目前堆的实现有很多种，具体如下</li>
</ul>
</li>
<li><h4 id="只有当真正访问一个地址的时候，系统才会建立虚拟页面与物理页面的映射关系。"><a href="#只有当真正访问一个地址的时候，系统才会建立虚拟页面与物理页面的映射关系。" class="headerlink" title="只有当真正访问一个地址的时候，系统才会建立虚拟页面与物理页面的映射关系。"></a>只有当真正访问一个地址的时候，系统才会建立虚拟页面与物理页面的映射关系。</h4></li>
<li></li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">dlmalloc  – General purpose allocator</span><br><span class="line">ptmalloc2 – glibc</span><br><span class="line">jemalloc  – FreeBSD and Firefox</span><br><span class="line">tcmalloc  – Google</span><br><span class="line">libumem   – Solaris</span><br></pre></td></tr></table></figure>
<h2 id="系统函数调用号："><a href="#系统函数调用号：" class="headerlink" title="系统函数调用号："></a>系统函数调用号：</h2><h3 id="32位"><a href="#32位" class="headerlink" title="32位"></a>32位</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br></pre></td><td class="code"><pre><span class="line">#ifndef _ASM_X86_UNISTD_32_H</span><br><span class="line">#define _ASM_X86_UNISTD_32_H 1</span><br><span class="line"></span><br><span class="line">#define __NR_restart_syscall 0</span><br><span class="line">#define __NR_exit 1</span><br><span class="line">#define __NR_fork 2</span><br><span class="line">#define __NR_read 3</span><br><span class="line">#define __NR_write 4</span><br><span class="line">#define __NR_open 5</span><br><span class="line">#define __NR_close 6</span><br><span class="line">#define __NR_waitpid 7</span><br><span class="line">#define __NR_creat 8</span><br><span class="line">#define __NR_link 9</span><br><span class="line">#define __NR_unlink 10</span><br><span class="line">#define __NR_execve 11</span><br><span class="line">#define __NR_chdir 12</span><br><span class="line">#define __NR_time 13</span><br><span class="line">#define __NR_mknod 14</span><br><span class="line">#define __NR_chmod 15</span><br><span class="line">#define __NR_lchown 16</span><br><span class="line">#define __NR_break 17</span><br><span class="line">#define __NR_oldstat 18</span><br><span class="line">#define __NR_lseek 19</span><br><span class="line">#define __NR_getpid 20</span><br><span class="line">#define __NR_mount 21</span><br><span class="line">#define __NR_umount 22</span><br><span class="line">#define __NR_setuid 23</span><br><span class="line">#define __NR_getuid 24</span><br><span class="line">#define __NR_stime 25</span><br><span class="line">#define __NR_ptrace 26</span><br><span class="line">#define __NR_alarm 27</span><br><span class="line">#define __NR_oldfstat 28</span><br><span class="line">#define __NR_pause 29</span><br><span class="line">#define __NR_utime 30</span><br><span class="line">#define __NR_stty 31</span><br><span class="line">#define __NR_gtty 32</span><br><span class="line">#define __NR_access 33</span><br><span class="line">#define __NR_nice 34</span><br><span class="line">#define __NR_ftime 35</span><br><span class="line">#define __NR_sync 36</span><br><span class="line">#define __NR_kill 37</span><br><span class="line">#define __NR_rename 38</span><br><span class="line">#define __NR_mkdir 39</span><br><span class="line">#define __NR_rmdir 40</span><br><span class="line">#define __NR_dup 41</span><br><span class="line">#define __NR_pipe 42</span><br><span class="line">#define __NR_times 43</span><br><span class="line">#define __NR_prof 44</span><br><span class="line">#define __NR_brk 45</span><br><span class="line">#define __NR_setgid 46</span><br><span class="line">#define __NR_getgid 47</span><br><span class="line">#define __NR_signal 48</span><br><span class="line">#define __NR_geteuid 49</span><br><span class="line">#define __NR_getegid 50</span><br><span class="line">#define __NR_acct 51</span><br><span class="line">#define __NR_umount2 52</span><br><span class="line">#define __NR_lock 53</span><br><span class="line">#define __NR_ioctl 54</span><br><span class="line">#define __NR_fcntl 55</span><br><span class="line">#define __NR_mpx 56</span><br><span class="line">#define __NR_setpgid 57</span><br><span class="line">#define __NR_ulimit 58</span><br><span class="line">#define __NR_oldolduname 59</span><br><span class="line">#define __NR_umask 60</span><br><span class="line">#define __NR_chroot 61</span><br><span class="line">#define __NR_ustat 62</span><br><span class="line">#define __NR_dup2 63</span><br><span class="line">#define __NR_getppid 64</span><br><span class="line">#define __NR_getpgrp 65</span><br><span class="line">#define __NR_setsid 66</span><br><span class="line">#define __NR_sigaction 67</span><br><span class="line">#define __NR_sgetmask 68</span><br><span class="line">#define __NR_ssetmask 69</span><br><span class="line">#define __NR_setreuid 70</span><br><span class="line">#define __NR_setregid 71</span><br><span class="line">#define __NR_sigsuspend 72</span><br><span class="line">#define __NR_sigpending 73</span><br><span class="line">#define __NR_sethostname 74</span><br><span class="line">#define __NR_setrlimit 75</span><br><span class="line">#define __NR_getrlimit 76</span><br><span class="line">#define __NR_getrusage 77</span><br><span class="line">#define __NR_gettimeofday 78</span><br><span class="line">#define __NR_settimeofday 79</span><br><span class="line">#define __NR_getgroups 80</span><br><span class="line">#define __NR_setgroups 81</span><br><span class="line">#define __NR_select 82</span><br><span class="line">#define __NR_symlink 83</span><br><span class="line">#define __NR_oldlstat 84</span><br><span class="line">#define __NR_readlink 85</span><br><span class="line">#define __NR_uselib 86</span><br><span class="line">#define __NR_swapon 87</span><br><span class="line">#define __NR_reboot 88</span><br><span class="line">#define __NR_readdir 89</span><br><span class="line">#define __NR_mmap 90</span><br><span class="line">#define __NR_munmap 91</span><br><span class="line">#define __NR_truncate 92</span><br><span class="line">#define __NR_ftruncate 93</span><br><span class="line">#define __NR_fchmod 94</span><br><span class="line">#define __NR_fchown 95</span><br><span class="line">#define __NR_getpriority 96</span><br><span class="line">#define __NR_setpriority 97</span><br><span class="line">#define __NR_profil 98</span><br><span class="line">#define __NR_statfs 99</span><br><span class="line">#define __NR_fstatfs 100</span><br><span class="line">#define __NR_ioperm 101</span><br><span class="line">#define __NR_socketcall 102</span><br><span class="line">#define __NR_syslog 103</span><br><span class="line">#define __NR_setitimer 104</span><br><span class="line">#define __NR_getitimer 105</span><br><span class="line">#define __NR_stat 106</span><br><span class="line">#define __NR_lstat 107</span><br><span class="line">#define __NR_fstat 108</span><br><span class="line">#define __NR_olduname 109</span><br><span class="line">#define __NR_iopl 110</span><br><span class="line">#define __NR_vhangup 111</span><br><span class="line">#define __NR_idle 112</span><br><span class="line">#define __NR_vm86old 113</span><br><span class="line">#define __NR_wait4 114</span><br><span class="line">#define __NR_swapoff 115</span><br><span class="line">#define __NR_sysinfo 116</span><br><span class="line">#define __NR_ipc 117</span><br><span class="line">#define __NR_fsync 118</span><br><span class="line">#define __NR_sigreturn 119</span><br><span class="line">#define __NR_clone 120</span><br><span class="line">#define __NR_setdomainname 121</span><br><span class="line">#define __NR_uname 122</span><br><span class="line">#define __NR_modify_ldt 123</span><br><span class="line">#define __NR_adjtimex 124</span><br><span class="line">#define __NR_mprotect 125</span><br><span class="line">#define __NR_sigprocmask 126</span><br><span class="line">#define __NR_create_module 127</span><br><span class="line">#define __NR_init_module 128</span><br><span class="line">#define __NR_delete_module 129</span><br><span class="line">#define __NR_get_kernel_syms 130</span><br><span class="line">#define __NR_quotactl 131</span><br><span class="line">#define __NR_getpgid 132</span><br><span class="line">#define __NR_fchdir 133</span><br><span class="line">#define __NR_bdflush 134</span><br><span class="line">#define __NR_sysfs 135</span><br><span class="line">#define __NR_personality 136</span><br><span class="line">#define __NR_afs_syscall 137</span><br><span class="line">#define __NR_setfsuid 138</span><br><span class="line">#define __NR_setfsgid 139</span><br><span class="line">#define __NR__llseek 140</span><br><span class="line">#define __NR_getdents 141</span><br><span class="line">#define __NR__newselect 142</span><br><span class="line">#define __NR_flock 143</span><br><span class="line">#define __NR_msync 144</span><br><span class="line">#define __NR_readv 145</span><br><span class="line">#define __NR_writev 146</span><br><span class="line">#define __NR_getsid 147</span><br><span class="line">#define __NR_fdatasync 148</span><br><span class="line">#define __NR__sysctl 149</span><br><span class="line">#define __NR_mlock 150</span><br><span class="line">#define __NR_munlock 151</span><br><span class="line">#define __NR_mlockall 152</span><br><span class="line">#define __NR_munlockall 153</span><br><span class="line">#define __NR_sched_setparam 154</span><br><span class="line">#define __NR_sched_getparam 155</span><br><span class="line">#define __NR_sched_setscheduler 156</span><br><span class="line">#define __NR_sched_getscheduler 157</span><br><span class="line">#define __NR_sched_yield 158</span><br><span class="line">#define __NR_sched_get_priority_max 159</span><br><span class="line">#define __NR_sched_get_priority_min 160</span><br><span class="line">#define __NR_sched_rr_get_interval 161</span><br><span class="line">#define __NR_nanosleep 162</span><br><span class="line">#define __NR_mremap 163</span><br><span class="line">#define __NR_setresuid 164</span><br><span class="line">#define __NR_getresuid 165</span><br><span class="line">#define __NR_vm86 166</span><br><span class="line">#define __NR_query_module 167</span><br><span class="line">#define __NR_poll 168</span><br><span class="line">#define __NR_nfsservctl 169</span><br><span class="line">#define __NR_setresgid 170</span><br><span class="line">#define __NR_getresgid 171</span><br><span class="line">#define __NR_prctl 172</span><br><span class="line">#define __NR_rt_sigreturn 173</span><br><span class="line">#define __NR_rt_sigaction 174</span><br><span class="line">#define __NR_rt_sigprocmask 175</span><br><span class="line">#define __NR_rt_sigpending 176</span><br><span class="line">#define __NR_rt_sigtimedwait 177</span><br><span class="line">#define __NR_rt_sigqueueinfo 178</span><br><span class="line">#define __NR_rt_sigsuspend 179</span><br><span class="line">#define __NR_pread64 180</span><br><span class="line">#define __NR_pwrite64 181</span><br><span class="line">#define __NR_chown 182</span><br><span class="line">#define __NR_getcwd 183</span><br><span class="line">#define __NR_capget 184</span><br><span class="line">#define __NR_capset 185</span><br><span class="line">#define __NR_sigaltstack 186</span><br><span class="line">#define __NR_sendfile 187</span><br><span class="line">#define __NR_getpmsg 188</span><br><span class="line">#define __NR_putpmsg 189</span><br><span class="line">#define __NR_vfork 190</span><br><span class="line">#define __NR_ugetrlimit 191</span><br><span class="line">#define __NR_mmap2 192</span><br><span class="line">#define __NR_truncate64 193</span><br><span class="line">#define __NR_ftruncate64 194</span><br><span class="line">#define __NR_stat64 195</span><br><span class="line">#define __NR_lstat64 196</span><br><span class="line">#define __NR_fstat64 197</span><br><span class="line">#define __NR_lchown32 198</span><br><span class="line">#define __NR_getuid32 199</span><br><span class="line">#define __NR_getgid32 200</span><br><span class="line">#define __NR_geteuid32 201</span><br><span class="line">#define __NR_getegid32 202</span><br><span class="line">#define __NR_setreuid32 203</span><br><span class="line">#define __NR_setregid32 204</span><br><span class="line">#define __NR_getgroups32 205</span><br><span class="line">#define __NR_setgroups32 206</span><br><span class="line">#define __NR_fchown32 207</span><br><span class="line">#define __NR_setresuid32 208</span><br><span class="line">#define __NR_getresuid32 209</span><br><span class="line">#define __NR_setresgid32 210</span><br><span class="line">#define __NR_getresgid32 211</span><br><span class="line">#define __NR_chown32 212</span><br><span class="line">#define __NR_setuid32 213</span><br><span class="line">#define __NR_setgid32 214</span><br><span class="line">#define __NR_setfsuid32 215</span><br><span class="line">#define __NR_setfsgid32 216</span><br><span class="line">#define __NR_pivot_root 217</span><br><span class="line">#define __NR_mincore 218</span><br><span class="line">#define __NR_madvise 219</span><br><span class="line">#define __NR_getdents64 220</span><br><span class="line">#define __NR_fcntl64 221</span><br><span class="line">#define __NR_gettid 224</span><br><span class="line">#define __NR_readahead 225</span><br><span class="line">#define __NR_setxattr 226</span><br><span class="line">#define __NR_lsetxattr 227</span><br><span class="line">#define __NR_fsetxattr 228</span><br><span class="line">#define __NR_getxattr 229</span><br><span class="line">#define __NR_lgetxattr 230</span><br><span class="line">#define __NR_fgetxattr 231</span><br><span class="line">#define __NR_listxattr 232</span><br><span class="line">#define __NR_llistxattr 233</span><br><span class="line">#define __NR_flistxattr 234</span><br><span class="line">#define __NR_removexattr 235</span><br><span class="line">#define __NR_lremovexattr 236</span><br><span class="line">#define __NR_fremovexattr 237</span><br><span class="line">#define __NR_tkill 238</span><br><span class="line">#define __NR_sendfile64 239</span><br><span class="line">#define __NR_futex 240</span><br><span class="line">#define __NR_sched_setaffinity 241</span><br><span class="line">#define __NR_sched_getaffinity 242</span><br><span class="line">#define __NR_set_thread_area 243</span><br><span class="line">#define __NR_get_thread_area 244</span><br><span class="line">#define __NR_io_setup 245</span><br><span class="line">#define __NR_io_destroy 246</span><br><span class="line">#define __NR_io_getevents 247</span><br><span class="line">#define __NR_io_submit 248</span><br><span class="line">#define __NR_io_cancel 249</span><br><span class="line">#define __NR_fadvise64 250</span><br><span class="line">#define __NR_exit_group 252</span><br><span class="line">#define __NR_lookup_dcookie 253</span><br><span class="line">#define __NR_epoll_create 254</span><br><span class="line">#define __NR_epoll_ctl 255</span><br><span class="line">#define __NR_epoll_wait 256</span><br><span class="line">#define __NR_remap_file_pages 257</span><br><span class="line">#define __NR_set_tid_address 258</span><br><span class="line">#define __NR_timer_create 259</span><br><span class="line">#define __NR_timer_settime 260</span><br><span class="line">#define __NR_timer_gettime 261</span><br><span class="line">#define __NR_timer_getoverrun 262</span><br><span class="line">#define __NR_timer_delete 263</span><br><span class="line">#define __NR_clock_settime 264</span><br><span class="line">#define __NR_clock_gettime 265</span><br><span class="line">#define __NR_clock_getres 266</span><br><span class="line">#define __NR_clock_nanosleep 267</span><br><span class="line">#define __NR_statfs64 268</span><br><span class="line">#define __NR_fstatfs64 269</span><br><span class="line">#define __NR_tgkill 270</span><br><span class="line">#define __NR_utimes 271</span><br><span class="line">#define __NR_fadvise64_64 272</span><br><span class="line">#define __NR_vserver 273</span><br><span class="line">#define __NR_mbind 274</span><br><span class="line">#define __NR_get_mempolicy 275</span><br><span class="line">#define __NR_set_mempolicy 276</span><br><span class="line">#define __NR_mq_open 277</span><br><span class="line">#define __NR_mq_unlink 278</span><br><span class="line">#define __NR_mq_timedsend 279</span><br><span class="line">#define __NR_mq_timedreceive 280</span><br><span class="line">#define __NR_mq_notify 281</span><br><span class="line">#define __NR_mq_getsetattr 282</span><br><span class="line">#define __NR_kexec_load 283</span><br><span class="line">#define __NR_waitid 284</span><br><span class="line">#define __NR_add_key 286</span><br><span class="line">#define __NR_request_key 287</span><br><span class="line">#define __NR_keyctl 288</span><br><span class="line">#define __NR_ioprio_set 289</span><br><span class="line">#define __NR_ioprio_get 290</span><br><span class="line">#define __NR_inotify_init 291</span><br><span class="line">#define __NR_inotify_add_watch 292</span><br><span class="line">#define __NR_inotify_rm_watch 293</span><br><span class="line">#define __NR_migrate_pages 294</span><br><span class="line">#define __NR_openat 295</span><br><span class="line">#define __NR_mkdirat 296</span><br><span class="line">#define __NR_mknodat 297</span><br><span class="line">#define __NR_fchownat 298</span><br><span class="line">#define __NR_futimesat 299</span><br><span class="line">#define __NR_fstatat64 300</span><br><span class="line">#define __NR_unlinkat 301</span><br><span class="line">#define __NR_renameat 302</span><br><span class="line">#define __NR_linkat 303</span><br><span class="line">#define __NR_symlinkat 304</span><br><span class="line">#define __NR_readlinkat 305</span><br><span class="line">#define __NR_fchmodat 306</span><br><span class="line">#define __NR_faccessat 307</span><br><span class="line">#define __NR_pselect6 308</span><br><span class="line">#define __NR_ppoll 309</span><br><span class="line">#define __NR_unshare 310</span><br><span class="line">#define __NR_set_robust_list 311</span><br><span class="line">#define __NR_get_robust_list 312</span><br><span class="line">#define __NR_splice 313</span><br><span class="line">#define __NR_sync_file_range 314</span><br><span class="line">#define __NR_tee 315</span><br><span class="line">#define __NR_vmsplice 316</span><br><span class="line">#define __NR_move_pages 317</span><br><span class="line">#define __NR_getcpu 318</span><br><span class="line">#define __NR_epoll_pwait 319</span><br><span class="line">#define __NR_utimensat 320</span><br><span class="line">#define __NR_signalfd 321</span><br><span class="line">#define __NR_timerfd_create 322</span><br><span class="line">#define __NR_eventfd 323</span><br><span class="line">#define __NR_fallocate 324</span><br><span class="line">#define __NR_timerfd_settime 325</span><br><span class="line">#define __NR_timerfd_gettime 326</span><br><span class="line">#define __NR_signalfd4 327</span><br><span class="line">#define __NR_eventfd2 328</span><br><span class="line">#define __NR_epoll_create1 329</span><br><span class="line">#define __NR_dup3 330</span><br><span class="line">#define __NR_pipe2 331</span><br><span class="line">#define __NR_inotify_init1 332</span><br><span class="line">#define __NR_preadv 333</span><br><span class="line">#define __NR_pwritev 334</span><br><span class="line">#define __NR_rt_tgsigqueueinfo 335</span><br><span class="line">#define __NR_perf_event_open 336</span><br><span class="line">#define __NR_recvmmsg 337</span><br><span class="line">#define __NR_fanotify_init 338</span><br><span class="line">#define __NR_fanotify_mark 339</span><br><span class="line">#define __NR_prlimit64 340</span><br><span class="line">#define __NR_name_to_handle_at 341</span><br><span class="line">#define __NR_open_by_handle_at 342</span><br><span class="line">#define __NR_clock_adjtime 343</span><br><span class="line">#define __NR_syncfs 344</span><br><span class="line">#define __NR_sendmmsg 345</span><br><span class="line">#define __NR_setns 346</span><br><span class="line">#define __NR_process_vm_readv 347</span><br><span class="line">#define __NR_process_vm_writev 348</span><br><span class="line">#define __NR_kcmp 349</span><br><span class="line">#define __NR_finit_module 350</span><br><span class="line">#define __NR_sched_setattr 351</span><br><span class="line">#define __NR_sched_getattr 352</span><br><span class="line">#define __NR_renameat2 353</span><br><span class="line">#define __NR_seccomp 354</span><br><span class="line">#define __NR_getrandom 355</span><br><span class="line">#define __NR_memfd_create 356</span><br><span class="line">#define __NR_bpf 357</span><br><span class="line">#define __NR_execveat 358</span><br><span class="line">#define __NR_socket 359</span><br><span class="line">#define __NR_socketpair 360</span><br><span class="line">#define __NR_bind 361</span><br><span class="line">#define __NR_connect 362</span><br><span class="line">#define __NR_listen 363</span><br><span class="line">#define __NR_accept4 364</span><br><span class="line">#define __NR_getsockopt 365</span><br><span class="line">#define __NR_setsockopt 366</span><br><span class="line">#define __NR_getsockname 367</span><br><span class="line">#define __NR_getpeername 368</span><br><span class="line">#define __NR_sendto 369</span><br><span class="line">#define __NR_sendmsg 370</span><br><span class="line">#define __NR_recvfrom 371</span><br><span class="line">#define __NR_recvmsg 372</span><br><span class="line">#define __NR_shutdown 373</span><br><span class="line">#define __NR_userfaultfd 374</span><br><span class="line">#define __NR_membarrier 375</span><br><span class="line">#define __NR_mlock2 376</span><br><span class="line">#define __NR_copy_file_range 377</span><br><span class="line">#define __NR_preadv2 378</span><br><span class="line">#define __NR_pwritev2 379</span><br><span class="line"></span><br><span class="line">#endif /* _ASM_X86_UNISTD_32_H */</span><br></pre></td></tr></table></figure>
<h3 id="64位"><a href="#64位" class="headerlink" title="64位"></a>64位</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br></pre></td><td class="code"><pre><span class="line">#ifndef _ASM_X86_UNISTD_64_H</span><br><span class="line">#define _ASM_X86_UNISTD_64_H 1</span><br><span class="line"></span><br><span class="line">#define __NR_read 0</span><br><span class="line">#define __NR_write 1</span><br><span class="line">#define __NR_open 2</span><br><span class="line">#define __NR_close 3</span><br><span class="line">#define __NR_stat 4</span><br><span class="line">#define __NR_fstat 5</span><br><span class="line">#define __NR_lstat 6</span><br><span class="line">#define __NR_poll 7</span><br><span class="line">#define __NR_lseek 8</span><br><span class="line">#define __NR_mmap 9</span><br><span class="line">#define __NR_mprotect 10</span><br><span class="line">#define __NR_munmap 11</span><br><span class="line">#define __NR_brk 12</span><br><span class="line">#define __NR_rt_sigaction 13</span><br><span class="line">#define __NR_rt_sigprocmask 14</span><br><span class="line">#define __NR_rt_sigreturn 15</span><br><span class="line">#define __NR_ioctl 16</span><br><span class="line">#define __NR_pread64 17</span><br><span class="line">#define __NR_pwrite64 18</span><br><span class="line">#define __NR_readv 19</span><br><span class="line">#define __NR_writev 20</span><br><span class="line">#define __NR_access 21</span><br><span class="line">#define __NR_pipe 22</span><br><span class="line">#define __NR_select 23</span><br><span class="line">#define __NR_sched_yield 24</span><br><span class="line">#define __NR_mremap 25</span><br><span class="line">#define __NR_msync 26</span><br><span class="line">#define __NR_mincore 27</span><br><span class="line">#define __NR_madvise 28</span><br><span class="line">#define __NR_shmget 29</span><br><span class="line">#define __NR_shmat 30</span><br><span class="line">#define __NR_shmctl 31</span><br><span class="line">#define __NR_dup 32</span><br><span class="line">#define __NR_dup2 33</span><br><span class="line">#define __NR_pause 34</span><br><span class="line">#define __NR_nanosleep 35</span><br><span class="line">#define __NR_getitimer 36</span><br><span class="line">#define __NR_alarm 37</span><br><span class="line">#define __NR_setitimer 38</span><br><span class="line">#define __NR_getpid 39</span><br><span class="line">#define __NR_sendfile 40</span><br><span class="line">#define __NR_socket 41</span><br><span class="line">#define __NR_connect 42</span><br><span class="line">#define __NR_accept 43</span><br><span class="line">#define __NR_sendto 44</span><br><span class="line">#define __NR_recvfrom 45</span><br><span class="line">#define __NR_sendmsg 46</span><br><span class="line">#define __NR_recvmsg 47</span><br><span class="line">#define __NR_shutdown 48</span><br><span class="line">#define __NR_bind 49</span><br><span class="line">#define __NR_listen 50</span><br><span class="line">#define __NR_getsockname 51</span><br><span class="line">#define __NR_getpeername 52</span><br><span class="line">#define __NR_socketpair 53</span><br><span class="line">#define __NR_setsockopt 54</span><br><span class="line">#define __NR_getsockopt 55</span><br><span class="line">#define __NR_clone 56</span><br><span class="line">#define __NR_fork 57</span><br><span class="line">#define __NR_vfork 58</span><br><span class="line">#define __NR_execve 59</span><br><span class="line">#define __NR_exit 60</span><br><span class="line">#define __NR_wait4 61</span><br><span class="line">#define __NR_kill 62</span><br><span class="line">#define __NR_uname 63</span><br><span class="line">#define __NR_semget 64</span><br><span class="line">#define __NR_semop 65</span><br><span class="line">#define __NR_semctl 66</span><br><span class="line">#define __NR_shmdt 67</span><br><span class="line">#define __NR_msgget 68</span><br><span class="line">#define __NR_msgsnd 69</span><br><span class="line">#define __NR_msgrcv 70</span><br><span class="line">#define __NR_msgctl 71</span><br><span class="line">#define __NR_fcntl 72</span><br><span class="line">#define __NR_flock 73</span><br><span class="line">#define __NR_fsync 74</span><br><span class="line">#define __NR_fdatasync 75</span><br><span class="line">#define __NR_truncate 76</span><br><span class="line">#define __NR_ftruncate 77</span><br><span class="line">#define __NR_getdents 78</span><br><span class="line">#define __NR_getcwd 79</span><br><span class="line">#define __NR_chdir 80</span><br><span class="line">#define __NR_fchdir 81</span><br><span class="line">#define __NR_rename 82</span><br><span class="line">#define __NR_mkdir 83</span><br><span class="line">#define __NR_rmdir 84</span><br><span class="line">#define __NR_creat 85</span><br><span class="line">#define __NR_link 86</span><br><span class="line">#define __NR_unlink 87</span><br><span class="line">#define __NR_symlink 88</span><br><span class="line">#define __NR_readlink 89</span><br><span class="line">#define __NR_chmod 90</span><br><span class="line">#define __NR_fchmod 91</span><br><span class="line">#define __NR_chown 92</span><br><span class="line">#define __NR_fchown 93</span><br><span class="line">#define __NR_lchown 94</span><br><span class="line">#define __NR_umask 95</span><br><span class="line">#define __NR_gettimeofday 96</span><br><span class="line">#define __NR_getrlimit 97</span><br><span class="line">#define __NR_getrusage 98</span><br><span class="line">#define __NR_sysinfo 99</span><br><span class="line">#define __NR_times 100</span><br><span class="line">#define __NR_ptrace 101</span><br><span class="line">#define __NR_getuid 102</span><br><span class="line">#define __NR_syslog 103</span><br><span class="line">#define __NR_getgid 104</span><br><span class="line">#define __NR_setuid 105</span><br><span class="line">#define __NR_setgid 106</span><br><span class="line">#define __NR_geteuid 107</span><br><span class="line">#define __NR_getegid 108</span><br><span class="line">#define __NR_setpgid 109</span><br><span class="line">#define __NR_getppid 110</span><br><span class="line">#define __NR_getpgrp 111</span><br><span class="line">#define __NR_setsid 112</span><br><span class="line">#define __NR_setreuid 113</span><br><span class="line">#define __NR_setregid 114</span><br><span class="line">#define __NR_getgroups 115</span><br><span class="line">#define __NR_setgroups 116</span><br><span class="line">#define __NR_setresuid 117</span><br><span class="line">#define __NR_getresuid 118</span><br><span class="line">#define __NR_setresgid 119</span><br><span class="line">#define __NR_getresgid 120</span><br><span class="line">#define __NR_getpgid 121</span><br><span class="line">#define __NR_setfsuid 122</span><br><span class="line">#define __NR_setfsgid 123</span><br><span class="line">#define __NR_getsid 124</span><br><span class="line">#define __NR_capget 125</span><br><span class="line">#define __NR_capset 126</span><br><span class="line">#define __NR_rt_sigpending 127</span><br><span class="line">#define __NR_rt_sigtimedwait 128</span><br><span class="line">#define __NR_rt_sigqueueinfo 129</span><br><span class="line">#define __NR_rt_sigsuspend 130</span><br><span class="line">#define __NR_sigaltstack 131</span><br><span class="line">#define __NR_utime 132</span><br><span class="line">#define __NR_mknod 133</span><br><span class="line">#define __NR_uselib 134</span><br><span class="line">#define __NR_personality 135</span><br><span class="line">#define __NR_ustat 136</span><br><span class="line">#define __NR_statfs 137</span><br><span class="line">#define __NR_fstatfs 138</span><br><span class="line">#define __NR_sysfs 139</span><br><span class="line">#define __NR_getpriority 140</span><br><span class="line">#define __NR_setpriority 141</span><br><span class="line">#define __NR_sched_setparam 142</span><br><span class="line">#define __NR_sched_getparam 143</span><br><span class="line">#define __NR_sched_setscheduler 144</span><br><span class="line">#define __NR_sched_getscheduler 145</span><br><span class="line">#define __NR_sched_get_priority_max 146</span><br><span class="line">#define __NR_sched_get_priority_min 147</span><br><span class="line">#define __NR_sched_rr_get_interval 148</span><br><span class="line">#define __NR_mlock 149</span><br><span class="line">#define __NR_munlock 150</span><br><span class="line">#define __NR_mlockall 151</span><br><span class="line">#define __NR_munlockall 152</span><br><span class="line">#define __NR_vhangup 153</span><br><span class="line">#define __NR_modify_ldt 154</span><br><span class="line">#define __NR_pivot_root 155</span><br><span class="line">#define __NR__sysctl 156</span><br><span class="line">#define __NR_prctl 157</span><br><span class="line">#define __NR_arch_prctl 158</span><br><span class="line">#define __NR_adjtimex 159</span><br><span class="line">#define __NR_setrlimit 160</span><br><span class="line">#define __NR_chroot 161</span><br><span class="line">#define __NR_sync 162</span><br><span class="line">#define __NR_acct 163</span><br><span class="line">#define __NR_settimeofday 164</span><br><span class="line">#define __NR_mount 165</span><br><span class="line">#define __NR_umount2 166</span><br><span class="line">#define __NR_swapon 167</span><br><span class="line">#define __NR_swapoff 168</span><br><span class="line">#define __NR_reboot 169</span><br><span class="line">#define __NR_sethostname 170</span><br><span class="line">#define __NR_setdomainname 171</span><br><span class="line">#define __NR_iopl 172</span><br><span class="line">#define __NR_ioperm 173</span><br><span class="line">#define __NR_create_module 174</span><br><span class="line">#define __NR_init_module 175</span><br><span class="line">#define __NR_delete_module 176</span><br><span class="line">#define __NR_get_kernel_syms 177</span><br><span class="line">#define __NR_query_module 178</span><br><span class="line">#define __NR_quotactl 179</span><br><span class="line">#define __NR_nfsservctl 180</span><br><span class="line">#define __NR_getpmsg 181</span><br><span class="line">#define __NR_putpmsg 182</span><br><span class="line">#define __NR_afs_syscall 183</span><br><span class="line">#define __NR_tuxcall 184</span><br><span class="line">#define __NR_security 185</span><br><span class="line">#define __NR_gettid 186</span><br><span class="line">#define __NR_readahead 187</span><br><span class="line">#define __NR_setxattr 188</span><br><span class="line">#define __NR_lsetxattr 189</span><br><span class="line">#define __NR_fsetxattr 190</span><br><span class="line">#define __NR_getxattr 191</span><br><span class="line">#define __NR_lgetxattr 192</span><br><span class="line">#define __NR_fgetxattr 193</span><br><span class="line">#define __NR_listxattr 194</span><br><span class="line">#define __NR_llistxattr 195</span><br><span class="line">#define __NR_flistxattr 196</span><br><span class="line">#define __NR_removexattr 197</span><br><span class="line">#define __NR_lremovexattr 198</span><br><span class="line">#define __NR_fremovexattr 199</span><br><span class="line">#define __NR_tkill 200</span><br><span class="line">#define __NR_time 201</span><br><span class="line">#define __NR_futex 202</span><br><span class="line">#define __NR_sched_setaffinity 203</span><br><span class="line">#define __NR_sched_getaffinity 204</span><br><span class="line">#define __NR_set_thread_area 205</span><br><span class="line">#define __NR_io_setup 206</span><br><span class="line">#define __NR_io_destroy 207</span><br><span class="line">#define __NR_io_getevents 208</span><br><span class="line">#define __NR_io_submit 209</span><br><span class="line">#define __NR_io_cancel 210</span><br><span class="line">#define __NR_get_thread_area 211</span><br><span class="line">#define __NR_lookup_dcookie 212</span><br><span class="line">#define __NR_epoll_create 213</span><br><span class="line">#define __NR_epoll_ctl_old 214</span><br><span class="line">#define __NR_epoll_wait_old 215</span><br><span class="line">#define __NR_remap_file_pages 216</span><br><span class="line">#define __NR_getdents64 217</span><br><span class="line">#define __NR_set_tid_address 218</span><br><span class="line">#define __NR_restart_syscall 219</span><br><span class="line">#define __NR_semtimedop 220</span><br><span class="line">#define __NR_fadvise64 221</span><br><span class="line">#define __NR_timer_create 222</span><br><span class="line">#define __NR_timer_settime 223</span><br><span class="line">#define __NR_timer_gettime 224</span><br><span class="line">#define __NR_timer_getoverrun 225</span><br><span class="line">#define __NR_timer_delete 226</span><br><span class="line">#define __NR_clock_settime 227</span><br><span class="line">#define __NR_clock_gettime 228</span><br><span class="line">#define __NR_clock_getres 229</span><br><span class="line">#define __NR_clock_nanosleep 230</span><br><span class="line">#define __NR_exit_group 231</span><br><span class="line">#define __NR_epoll_wait 232</span><br><span class="line">#define __NR_epoll_ctl 233</span><br><span class="line">#define __NR_tgkill 234</span><br><span class="line">#define __NR_utimes 235</span><br><span class="line">#define __NR_vserver 236</span><br><span class="line">#define __NR_mbind 237</span><br><span class="line">#define __NR_set_mempolicy 238</span><br><span class="line">#define __NR_get_mempolicy 239</span><br><span class="line">#define __NR_mq_open 240</span><br><span class="line">#define __NR_mq_unlink 241</span><br><span class="line">#define __NR_mq_timedsend 242</span><br><span class="line">#define __NR_mq_timedreceive 243</span><br><span class="line">#define __NR_mq_notify 244</span><br><span class="line">#define __NR_mq_getsetattr 245</span><br><span class="line">#define __NR_kexec_load 246</span><br><span class="line">#define __NR_waitid 247</span><br><span class="line">#define __NR_add_key 248</span><br><span class="line">#define __NR_request_key 249</span><br><span class="line">#define __NR_keyctl 250</span><br><span class="line">#define __NR_ioprio_set 251</span><br><span class="line">#define __NR_ioprio_get 252</span><br><span class="line">#define __NR_inotify_init 253</span><br><span class="line">#define __NR_inotify_add_watch 254</span><br><span class="line">#define __NR_inotify_rm_watch 255</span><br><span class="line">#define __NR_migrate_pages 256</span><br><span class="line">#define __NR_openat 257</span><br><span class="line">#define __NR_mkdirat 258</span><br><span class="line">#define __NR_mknodat 259</span><br><span class="line">#define __NR_fchownat 260</span><br><span class="line">#define __NR_futimesat 261</span><br><span class="line">#define __NR_newfstatat 262</span><br><span class="line">#define __NR_unlinkat 263</span><br><span class="line">#define __NR_renameat 264</span><br><span class="line">#define __NR_linkat 265</span><br><span class="line">#define __NR_symlinkat 266</span><br><span class="line">#define __NR_readlinkat 267</span><br><span class="line">#define __NR_fchmodat 268</span><br><span class="line">#define __NR_faccessat 269</span><br><span class="line">#define __NR_pselect6 270</span><br><span class="line">#define __NR_ppoll 271</span><br><span class="line">#define __NR_unshare 272</span><br><span class="line">#define __NR_set_robust_list 273</span><br><span class="line">#define __NR_get_robust_list 274</span><br><span class="line">#define __NR_splice 275</span><br><span class="line">#define __NR_tee 276</span><br><span class="line">#define __NR_sync_file_range 277</span><br><span class="line">#define __NR_vmsplice 278</span><br><span class="line">#define __NR_move_pages 279</span><br><span class="line">#define __NR_utimensat 280</span><br><span class="line">#define __NR_epoll_pwait 281</span><br><span class="line">#define __NR_signalfd 282</span><br><span class="line">#define __NR_timerfd_create 283</span><br><span class="line">#define __NR_eventfd 284</span><br><span class="line">#define __NR_fallocate 285</span><br><span class="line">#define __NR_timerfd_settime 286</span><br><span class="line">#define __NR_timerfd_gettime 287</span><br><span class="line">#define __NR_accept4 288</span><br><span class="line">#define __NR_signalfd4 289</span><br><span class="line">#define __NR_eventfd2 290</span><br><span class="line">#define __NR_epoll_create1 291</span><br><span class="line">#define __NR_dup3 292</span><br><span class="line">#define __NR_pipe2 293</span><br><span class="line">#define __NR_inotify_init1 294</span><br><span class="line">#define __NR_preadv 295</span><br><span class="line">#define __NR_pwritev 296</span><br><span class="line">#define __NR_rt_tgsigqueueinfo 297</span><br><span class="line">#define __NR_perf_event_open 298</span><br><span class="line">#define __NR_recvmmsg 299</span><br><span class="line">#define __NR_fanotify_init 300</span><br><span class="line">#define __NR_fanotify_mark 301</span><br><span class="line">#define __NR_prlimit64 302</span><br><span class="line">#define __NR_name_to_handle_at 303</span><br><span class="line">#define __NR_open_by_handle_at 304</span><br><span class="line">#define __NR_clock_adjtime 305</span><br><span class="line">#define __NR_syncfs 306</span><br><span class="line">#define __NR_sendmmsg 307</span><br><span class="line">#define __NR_setns 308</span><br><span class="line">#define __NR_getcpu 309</span><br><span class="line">#define __NR_process_vm_readv 310</span><br><span class="line">#define __NR_process_vm_writev 311</span><br><span class="line">#define __NR_kcmp 312</span><br><span class="line">#define __NR_finit_module 313</span><br><span class="line">#define __NR_sched_setattr 314</span><br><span class="line">#define __NR_sched_getattr 315</span><br><span class="line">#define __NR_renameat2 316</span><br><span class="line">#define __NR_seccomp 317</span><br><span class="line">#define __NR_getrandom 318</span><br><span class="line">#define __NR_memfd_create 319</span><br><span class="line">#define __NR_kexec_file_load 320</span><br><span class="line">#define __NR_bpf 321</span><br><span class="line">#define __NR_execveat 322</span><br><span class="line">#define __NR_userfaultfd 323</span><br><span class="line">#define __NR_membarrier 324</span><br><span class="line">#define __NR_mlock2 325</span><br><span class="line">#define __NR_copy_file_range 326</span><br><span class="line">#define __NR_preadv2 327</span><br><span class="line">#define __NR_pwritev2 328</span><br><span class="line"></span><br><span class="line">#endif /* _ASM_X86_UNISTD_64_H */</span><br></pre></td></tr></table></figure>

      
    </div>

    

    
    
    
    <div>
      
        <div>
    
        <div style="text-align:center;color: #ccc;font-size:14px;">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div>
    
</div>

      
    </div>
    

    
      
    
    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/PWN/" rel="tag"><i class="fa fa-tag"></i> PWN</a>
          
            <a href="/tags/GDB/" rel="tag"><i class="fa fa-tag"></i> GDB</a>
          
            <a href="/tags/peda/" rel="tag"><i class="fa fa-tag"></i> peda</a>
          
            <a href="/tags/gef/" rel="tag"><i class="fa fa-tag"></i> gef</a>
          
            <a href="/tags/pwndbg/" rel="tag"><i class="fa fa-tag"></i> pwndbg</a>
          
            <a href="/tags/PWNTOOLS/" rel="tag"><i class="fa fa-tag"></i> PWNTOOLS</a>
          
            <a href="/tags/ASLR/" rel="tag"><i class="fa fa-tag"></i> ASLR</a>
          
            <a href="/tags/DEP/" rel="tag"><i class="fa fa-tag"></i> DEP</a>
          
            <a href="/tags/堆/" rel="tag"><i class="fa fa-tag"></i> 堆</a>
          
            <a href="/tags/栈/" rel="tag"><i class="fa fa-tag"></i> 栈</a>
          
            <a href="/tags/objdump/" rel="tag"><i class="fa fa-tag"></i> objdump</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2019/01/14/逆向初识/" rel="next" title="逆向初识">
                <i class="fa fa-chevron-left"></i> 逆向初识
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2019/01/14/阶段总结/" rel="prev" title="阶段总结">
                阶段总结 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>


  </div>


          </div>
          

  
    <div class="comments id=" gitalk-container"="">
    </div>

  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/avatar.gif" alt="Healer">
            
              <p class="site-author-name" itemprop="name">Healer</p>
              <p class="site-description motion-element" itemprop="description">桃李不言，下自成蹊</p>
          </div>

          
            <nav class="site-state motion-element">
              
                <div class="site-state-item site-state-posts">
                
                  <a href="/archives/">
                
                    <span class="site-state-item-count">49</span>
                    <span class="site-state-item-name">日志</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-categories">
                  <a href="/categories/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">7</span>
                    <span class="site-state-item-name">分类</span>
                  </a>
                </div>
              

              
                
                
                <div class="site-state-item site-state-tags">
                  <a href="/tags/index.html">
                    
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                      
                    
                    <span class="site-state-item-count">72</span>
                    <span class="site-state-item-name">标签</span>
                  </a>
                </div>
              
            </nav>
          

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          
            <div class="links-of-author motion-element">
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://github.com/JD1412/JD1412.github.io" title="GitHub &rarr; https://github.com/JD1412/JD1412.github.io"><i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  
                  
                    
                  
                  
                    
                  
                  <a href="https://www.google.com" title="Google &rarr; https://www.google.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-google"></i>Google</a>
                </span>
              
            </div>
          

          

          
          

          
            
          
          

        </div>
      </div>

      
      <!--noindex-->
        <div class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
            
            
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#PWN-学习笔记"><span class="nav-number">1.</span> <span class="nav-text">PWN 学习笔记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#linux保护机制整理"><span class="nav-number">1.1.</span> <span class="nav-text">linux保护机制整理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#分析漏洞"><span class="nav-number">1.2.</span> <span class="nav-text">分析漏洞</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#写exp"><span class="nav-number">1.3.</span> <span class="nav-text">写exp</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#PWNTOOLS的基本使用方法"><span class="nav-number">1.4.</span> <span class="nav-text">PWNTOOLS的基本使用方法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#一些基础知识点"><span class="nav-number">1.5.</span> <span class="nav-text">一些基础知识点</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#x64下前6个参数不是保存在栈中，而是通过寄存器传值"><span class="nav-number">1.5.1.</span> <span class="nav-text">x64下前6个参数不是保存在栈中，而是通过寄存器传值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ELF文件加载到内存中的状态"><span class="nav-number">1.5.2.</span> <span class="nav-text">ELF文件加载到内存中的状态</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#确定缓冲区大小的peda方法："><span class="nav-number">1.6.</span> <span class="nav-text">确定缓冲区大小的peda方法：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#确定缓冲区大小的gef方法："><span class="nav-number">1.7.</span> <span class="nav-text">确定缓冲区大小的gef方法：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#使gef的调试信息输出到不同的终端窗口"><span class="nav-number">1.8.</span> <span class="nav-text">使gef的调试信息输出到不同的终端窗口</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#objdump使用相关技巧"><span class="nav-number">1.9.</span> <span class="nav-text">objdump使用相关技巧</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#常用的查找偏移的办法"><span class="nav-number">1.10.</span> <span class="nav-text">常用的查找偏移的办法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#gef工具与pwndbg调试工具区别"><span class="nav-number">1.11.</span> <span class="nav-text">gef工具与pwndbg调试工具区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GDB调试技巧"><span class="nav-number">1.12.</span> <span class="nav-text">GDB调试技巧</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#汇编语言ret后带一个参数的执行方式"><span class="nav-number">1.13.</span> <span class="nav-text">汇编语言ret后带一个参数的执行方式</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#ROP-Return-Oriented-Programming"><span class="nav-number">2.</span> <span class="nav-text">ROP(Return Oriented Programming)</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#基本ROP"><span class="nav-number">2.1.</span> <span class="nav-text">基本ROP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ret2text-ret2syscall-ret2shellcode-ret2libc"><span class="nav-number">2.1.1.</span> <span class="nav-text">ret2text,ret2syscall,ret2shellcode,ret2libc</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ret2resolve"><span class="nav-number">2.1.2.</span> <span class="nav-text">ret2resolve</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#使用readelf查看动态段-dynamic-的信息"><span class="nav-number">2.1.2.1.</span> <span class="nav-text">使用readelf查看动态段  .dynamic  的信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#查看-rel-plt-表中的信息，使用命令readelf-r-babystack"><span class="nav-number">2.1.2.2.</span> <span class="nav-text">查看  .rel.plt  表中的信息，使用命令readelf -r babystack</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#中级ROP"><span class="nav-number">2.2.</span> <span class="nav-text">中级ROP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ret2-libc-csu-init"><span class="nav-number">2.2.1.</span> <span class="nav-text">ret2__libc_csu_init</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BROP"><span class="nav-number">2.2.2.</span> <span class="nav-text">BROP</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#高级ROP"><span class="nav-number">2.3.</span> <span class="nav-text">高级ROP</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#堆溢出利用"><span class="nav-number">3.</span> <span class="nav-text">堆溢出利用</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#只有当真正访问一个地址的时候，系统才会建立虚拟页面与物理页面的映射关系。"><span class="nav-number">3.0.0.1.</span> <span class="nav-text">只有当真正访问一个地址的时候，系统才会建立虚拟页面与物理页面的映射关系。</span></a></li></ol></li></ol><li class="nav-item nav-level-2"><a class="nav-link" href="#系统函数调用号："><span class="nav-number">3.1.</span> <span class="nav-text">系统函数调用号：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#32位"><span class="nav-number">3.1.1.</span> <span class="nav-text">32位</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#64位"><span class="nav-number">3.1.2.</span> <span class="nav-text">64位</span></a></li></ol></li></div>
            

          </div>
        </div>
      <!--/noindex-->
      
      
	<script type="text/javascript" charset="utf-8" src="/js/tagcloud.js"></script>
	<script type="text/javascript" charset="utf-8" src="/js/tagcanvas.js"></script>
	<div class="widget-wrap">
	    <h3 class="widget-title">Tag Cloud</h3>
	    <div id="myCanvasContainer" class="widget tagcloud">
		<canvas width="250" height="250" id="resCanvas" style="width=100%">
		    <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/ARP欺骗/">ARP欺骗</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ASLR/">ASLR</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ASP/">ASP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CANARY/">CANARY</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CISCN/">CISCN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CMD/">CMD</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/CTF/">CTF</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DEP/">DEP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/DNS欺骗/">DNS欺骗</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Eternalblue/">Eternalblue</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ettercap/">Ettercap</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Fuzzbuunch/">Fuzzbuunch</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/GDB/">GDB</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/IDA/">IDA</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/KALI/">KALI</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Linux/">Linux</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MARKDOWN/">MARKDOWN</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MD5/">MD5</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MITM/">MITM</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MS08-067/">MS08-067</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/MS12-004/">MS12_004</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Metasploit/">Metasploit</a><span class="tag-list-count">7</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Misc/">Misc</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/NSA武器库/">NSA武器库</a><span class="tag-list-count">8</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nmap/">Nmap</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ollydbg/">Ollydbg</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PWN/">PWN</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/PWNTOOLS/">PWNTOOLS</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Python/">Python</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ROP/">ROP</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Requests/">Requests</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Reverse/">Reverse</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Revese/">Revese</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Ruby/">Ruby</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/SQLMAP/">SQLMAP</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Shell脚本/">Shell脚本</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/VMware-Tools/">VMware Tools</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/W3AF/">W3AF</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WEB/">WEB</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WIFI/">WIFI</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WIFI密码破解/">WIFI密码破解</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/WIFI拒绝服务/">WIFI拒绝服务</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Windows/">Windows</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Writeup/">Writeup</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/XSS/">XSS</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/arpspoof/">arpspoof</a><span class="tag-list-count">4</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/canary/">canary</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/driftnet/">driftnet</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gef/">gef</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/meterpreter/">meterpreter</a><span class="tag-list-count">9</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/objdump/">objdump</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/peda/">peda</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/pwndbg/">pwndbg</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/re/">re</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ret2-libc-csu-init/">ret2_libc_csu_init</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shell/">shell</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/shellcode/">shellcode</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/全国大学生信息安全竞赛/">全国大学生信息安全竞赛</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/反爬虫/">反爬虫</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/图片/">图片</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/堆/">堆</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/数据库注入/">数据库注入</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/断网攻击/">断网攻击</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/更新源/">更新源</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/木马/">木马</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/栈/">栈</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/格式化字符串/">格式化字符串</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/正则表达式/">正则表达式</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/爬虫/">爬虫</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/磁盘分区合并/">磁盘分区合并</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/缓冲区溢出/">缓冲区溢出</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/逆向/">逆向</a><span class="tag-list-count">1</span></li></ul>
		</canvas>
	    </div>
	</div>
	
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love" id="animate">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Healer</span>

  

  
</div>

<div class="powered-by">
<i class="fa fa-user-md"></i><span id="busuanzi_container_site_uv">
  本站访客数:<span id="busuanzi_value_site_pv"></span>
</span><span class="post-meta-divider">|</span>
</div>


  <div class="powered-by">由 <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> 强力驱动 v3.8.0</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 – <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> v6.7.0</div>




        








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

    

    
  </div>

  

<script>
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>














  
    
    
  
  <script color="0,0,255" opacity="0.5" zindex="-1" count="99" src="/lib/canvas-nest/canvas-nest.min.js"></script>













  
  <script src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>


  


  <script src="/js/src/utils.js?v=6.7.0"></script>

  <script src="/js/src/motion.js?v=6.7.0"></script>



  
  


  <script src="/js/src/affix.js?v=6.7.0"></script>

  <script src="/js/src/schemes/pisces.js?v=6.7.0"></script>




  
  <script src="/js/src/scrollspy.js?v=6.7.0"></script>
<script src="/js/src/post-details.js?v=6.7.0"></script>



  


  <script src="/js/src/bootstrap.js?v=6.7.0"></script>



  
  
    

<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>



<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.css">



<script src="//cdn.jsdelivr.net/npm/js-md5@0.7.3/src/md5.min.js"></script>

  <link rel="stylesheet" href="https://unpkg.com/gitalk/dist/gitalk.css">
  <script src="https://unpkg.com/gitalk/dist/gitalk.min.js"></script>
  <script src="https://cdn.bootcss.com/blueimp-md5/2.10.0/js/md5.min.js"></script>
   <script type="text/javascript">
        var gitalk = new Gitalk({
          clientID: '',
          clientSecret: '',
          repo: 'MY_Blog',
          owner: '',
          admin: [''],
          id: md5(window.location.pathname),
          distractionFreeMode: ''
        })
        gitalk.render('gitalk-container')
       </script>

  







  

  <script>
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url).replace(/\/{2,}/g, '/');
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x"></i></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x"></i></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  

  

  

  

  

  

  

  
  <script type="text/javascript" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>
  
  
   <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;"></canvas> 
   <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
   <script type="text/javascript" src="/js/src/fireworks.js"></script>
  
 
<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"model":{"jsonPath":"/live2dw/assets/z16.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
